<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coiffeur Admin - Espace Priv√©</title>
    <!-- Favicon LVN -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='256' height='256' viewBox='0 0 256 256'%3E%3Crect width='256' height='256' fill='%23ffffff'/%3E%3Ctext x='50%' y='55%' dominant-baseline='middle' text-anchor='middle' font-family='Inter, Arial, sans-serif' font-size='140' fill='%23000000' font-weight='700'%3ELVN%3C/text%3E%3C/svg%3E" />
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            /* Cacher tous les scrollbars pour une interface propre */
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none; /* IE et Edge */
        }
        
        *::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Opera */
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #ffffff;
            min-height: 100vh;
            color: #000000;
            overflow-x: hidden;
            overflow-y: auto; /* Scroll vertical possible */
            position: relative;
            opacity: 0;
            animation: pageLoad 0.8s ease-out forwards;
        }

        @keyframes pageLoad {
            to {
                opacity: 1;
            }
        }


        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(ellipse at 20% 50%, rgba(245, 158, 11, 0.08) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 20%, rgba(147, 51, 234, 0.06) 0%, transparent 50%),
                radial-gradient(ellipse at 40% 80%, rgba(16, 185, 129, 0.04) 0%, transparent 50%),
                #ffffff;
            pointer-events: none;
            z-index: 0;
            animation: gradientShift 15s ease-in-out infinite;
        }

        @keyframes gradientShift {
            0%, 100% {
                opacity: 1;
                transform: scale(1) rotate(0deg);
            }
            33% {
                opacity: 0.8;
                transform: scale(1.05) rotate(1deg);
            }
            66% {
                opacity: 0.9;
                transform: scale(0.98) rotate(-0.5deg);
            }
        }


        .container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            z-index: 1;
            padding: 20px;
        }

        .login-card {
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 24px;
            padding: 60px 50px;
            text-align: center;
            max-width: 500px;
            width: 100%;
            position: relative;
            transform: translateY(80px) scale(0.8);
            opacity: 0;
            animation: cardEntrance 1.2s cubic-bezier(0.4, 0, 0.2, 1) 0.3s forwards;
            box-shadow: 
                0 25px 50px rgba(0, 0, 0, 0.1),
                0 0 0 1px rgba(255, 255, 255, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.4);
            overflow: hidden;
        }

        .login-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.1) 0%, 
                rgba(255, 255, 255, 0.05) 50%, 
                rgba(255, 255, 255, 0.1) 100%);
            border-radius: 24px;
            pointer-events: none;
            z-index: -1;
        }

        @keyframes cardEntrance {
            0% {
                transform: translateY(80px) scale(0.8);
                opacity: 0;
            }
            60% {
                transform: translateY(-10px) scale(1.02);
                opacity: 0.8;
            }
            100% {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
        }


        .title {
            font-size: clamp(2.8rem, 5vw, 4.5rem);
            font-weight: 700;
            margin-bottom: 16px;
            color: #000000;
            letter-spacing: -0.03em;
            line-height: 0.85;
            opacity: 0;
            transform: translateY(30px);
            animation: titleEntrance 0.8s cubic-bezier(0.4, 0, 0.2, 1) 0.8s forwards;
        }

        @keyframes titleEntrance {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .subtitle {
            color: rgba(0, 0, 0, 0.6);
            margin-bottom: 48px;
            font-size: 0.9rem;
            font-weight: 400;
            letter-spacing: 0.5px;
            opacity: 0;
            transform: translateY(20px);
            animation: subtitleEntrance 0.7s cubic-bezier(0.4, 0, 0.2, 1) 1.1s forwards;
        }

        @keyframes subtitleEntrance {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .admin-btn {
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #ffffff;
            padding: 16px 32px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 600;
            letter-spacing: 0.5px;
            border-radius: 999px;
            position: relative;
            overflow: hidden;
            box-shadow: 
                0 8px 25px rgba(0, 0, 0, 0.2),
                0 0 0 1px rgba(255, 255, 255, 0.05),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            opacity: 0;
            transform: translateY(25px) scale(0.95);
            animation: buttonEntrance 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) 1.2s forwards;
        }

        @keyframes buttonEntrance {
            0% {
                opacity: 0;
                transform: translateY(30px) scale(0.9);
            }
            70% {
                opacity: 0.8;
                transform: translateY(-5px) scale(1.05);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .admin-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .admin-btn:hover::before {
            left: 100%;
        }

        .admin-btn:hover {
            background: rgba(30, 30, 30, 0.9);
            transform: translateY(-4px) scale(1.02);
            box-shadow: 
                0 15px 35px rgba(0, 0, 0, 0.25),
                0 0 0 1px rgba(255, 255, 255, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }

        .admin-btn:active {
            transform: translateY(-2px) scale(0.98);
            transition: all 0.1s ease;
        }

        .password-form {
            margin-top: 40px;
            max-height: 0;
            overflow: hidden;
            opacity: 0;
            transform: translateY(-20px);
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .password-form.show {
            max-height: 300px;
            opacity: 1;
            transform: translateY(0);
        }

        .password-form .password-input,
        .password-form .login-btn,
        .password-form .error-message {
            transform: translateY(20px);
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .password-form.show .password-input {
            transform: translateY(0);
            opacity: 1;
            transition-delay: 0.2s;
        }

        .password-form.show .login-btn {
            transform: translateY(0);
            opacity: 1;
            transition-delay: 0.3s;
        }

        .password-form.show .error-message.show {
            transform: translateY(0);
            opacity: 1;
            transition-delay: 0.4s;
        }

        .password-input-container {
            position: relative;
            width: 100%;
            margin-bottom: 30px;
        }

        .password-input {
            width: 100%;
            padding: 18px 20px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            color: #000000;
            font-size: 1rem;
            font-weight: 400;
            border-radius: 12px;
            position: relative;
            box-shadow: 
                0 4px 15px rgba(0, 0, 0, 0.05),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
        }

        .login-btn {
            background: rgba(255, 255, 255, 0.07);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: white;
            padding: 16px 32px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            letter-spacing: 0.5px;
            font-size: 0.9rem;
            border-radius: 999px;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .password-input:focus {
            outline: none;
            border-color: rgba(245, 158, 11, 0.6);
            box-shadow: 
                0 0 0 3px rgba(245, 158, 11, 0.15),
                0 4px 20px rgba(245, 158, 11, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.4);
            background: rgba(255, 255, 255, 0.3);
        }

        .password-input::placeholder {
            color: rgba(0, 0, 0, 0.5);
            font-weight: 400;
        }

        .login-btn {
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: white;
            padding: 16px 32px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            letter-spacing: 0.5px;
            font-size: 0.9rem;
            border-radius: 999px;
            position: relative;
            overflow: hidden;
            box-shadow: 
                0 8px 25px rgba(0, 0, 0, 0.2),
                0 0 0 1px rgba(255, 255, 255, 0.05),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .login-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .login-btn:hover::before {
            left: 100%;
        }

        .login-btn:hover {
            background: rgba(30, 30, 30, 0.9);
            transform: translateY(-4px) scale(1.02);
            box-shadow: 
                0 15px 35px rgba(0, 0, 0, 0.25),
                0 0 0 1px rgba(255, 255, 255, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }

        .login-btn:active {
            transform: translateY(-2px) scale(0.98);
            transition: all 0.1s ease;
        }

        .error-message {
            color: #ef4444;
            margin-top: 20px;
            font-size: 0.85rem;
            opacity: 0;
            transform: translateY(15px) scale(0.9);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            padding: 12px 16px;
            backdrop-filter: blur(10px);
            letter-spacing: 0.5px;
        }

        .error-message.show {
            opacity: 1;
            transform: translateY(0) scale(1);
            animation: errorShake 0.5s ease-out;
        }

        @keyframes errorShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .loading {
            display: none;
            margin-top: 30px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-top: 3px solid #3b82f6;
            border-right: 3px solid #8b5cf6;
            border-radius: 50%;
            animation: spinGlow 1.2s cubic-bezier(0.4, 0, 0.2, 1) infinite;
            margin: 0 auto;
            filter: drop-shadow(0 0 10px rgba(245, 158, 11, 0.5));
        }

        @keyframes spinGlow {
            0% { 
                transform: rotate(0deg) scale(1);
                filter: drop-shadow(0 0 10px rgba(245, 158, 11, 0.5));
            }
            50% { 
                transform: rotate(180deg) scale(1.1);
                filter: drop-shadow(0 0 20px rgba(139, 92, 246, 0.7));
            }
            100% { 
                transform: rotate(360deg) scale(1);
                filter: drop-shadow(0 0 10px rgba(245, 158, 11, 0.5));
            }
        }


        .admin-panel {
            display: none;
            min-height: 100vh;
            padding: 20px;
            color: #000000;
            position: relative;
            z-index: 1;
            opacity: 0;
            transform: translateY(40px) scale(0.9);
            transition: all 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .admin-container {
            max-width: 1400px;
            width: 100%;
            margin: 0 auto;
            height: calc(100vh - 40px);
            position: relative;
            display: flex;
            flex-direction: column;
        }

        .admin-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.1) 0%, 
                rgba(255, 255, 255, 0.05) 50%, 
                rgba(255, 255, 255, 0.1) 100%);
            border-radius: 24px;
            pointer-events: none;
            z-index: -1;
        }

        .admin-panel.show {
            opacity: 1;
            transform: translateY(0) scale(1);
            animation: panelBounceIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes panelBounceIn {
            0% {
                opacity: 0;
                transform: translateY(40px) scale(0.9);
            }
            60% {
                opacity: 0.9;
                transform: translateY(-5px) scale(1.02);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .admin-header {
            text-align: center;
            margin-bottom: 30px;
            opacity: 0;
            transform: translateY(20px);
            padding: 20px;
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .admin-header.animate {
            opacity: 1;
            transform: translateY(0);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .rdv-system.animate {
            opacity: 1 !important;
            transform: translateY(0) !important;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .admin-title {
            font-size: clamp(2rem, 4vw, 3rem);
            font-weight: 700;
            color: #000000;
            margin-bottom: 20px;
            letter-spacing: -0.03em;
        }

        .logout-btn {
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #ffffff;
            padding: 12px 24px;
            cursor: pointer;
            font-weight: 600;
            margin-top: 25px;
            transition: all 0.3s ease;
            letter-spacing: 0.5px;
            font-size: 0.85rem;
            border-radius: 999px;
            position: relative;
            overflow: hidden;
            box-shadow: 
                0 6px 20px rgba(0, 0, 0, 0.15),
                0 0 0 1px rgba(255, 255, 255, 0.05),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .logout-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s ease;
        }

        .logout-btn:hover::before {
            left: 100%;
        }
        
        .logout-btn:hover {
            background: rgba(30, 30, 30, 0.9);
            transform: translateY(-1px);
            box-shadow: 
                0 8px 25px rgba(0, 0, 0, 0.2),
                0 0 0 1px rgba(255, 255, 255, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }

        /* Layout Styles */
        .top-nav {
            background: rgba(255, 255, 255, 0.02);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.02),
                inset 0 1px 0 rgba(255, 255, 255, 0.08);
        }

        .nav-menu {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 16px;
            background: rgba(255, 255, 255, 0.01);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            color: rgba(0, 0, 0, 0.9);
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 600;
            min-width: 120px;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.01);
        }

        .nav-item:hover {
            background: rgba(255, 255, 255, 0.04);
            transform: translateY(-2px);
            color: rgba(0, 0, 0, 1);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.03);
        }

        .nav-item.active {
            background: rgba(255, 255, 255, 0.06);
            border-color: rgba(255, 255, 255, 0.08);
            color: #000000;
            font-weight: 700;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.04);
        }

        .nav-icon {
            font-size: 1.1rem;
        }

        .nav-label {
            font-size: 0.9rem;
            letter-spacing: 0.3px;
        }

        .main-content {
            padding: 0;
            overflow-y: auto;
            flex: 1;
            min-height: 0;
        }

        .logout-btn-top {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 16px;
            background: rgba(239, 68, 68, 0.02);
            border: 1px solid rgba(239, 68, 68, 0.05);
            border-radius: 12px;
            color: rgba(220, 38, 38, 1);
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 600;
            backdrop-filter: blur(20px);
        }

        .logout-btn-top:hover {
            background: rgba(239, 68, 68, 0.04);
            border-color: rgba(239, 68, 68, 0.08);
            color: rgb(185, 28, 28);
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(239, 68, 68, 0.04);
        }

        .logout-icon {
            font-size: 1.1rem;
        }

        .logout-text {
            font-size: 0.9rem;
            letter-spacing: 0.3px;
        }

        .page-content {
            display: none;
            animation: pageSlideIn 0.3s ease-out;
            width: 100%;
            height: 100%;
            padding: 20px;
            overflow-y: auto;
            overflow-x: hidden;
        }

        .page-content.active {
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: stretch;
        }

        @keyframes pageSlideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.015);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.04);
            border-radius: 16px;
            flex-wrap: wrap;
            gap: 20px;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.015),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
        }

        .page-title {
            font-size: clamp(1.8rem, 3vw, 2.5rem);
            font-weight: 700;
            color: #000000;
            margin: 0;
        }

        .page-actions {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .coming-soon {
            text-align: center;
            padding: 80px 20px;
            background: rgba(255, 255, 255, 0.015);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.04);
            border-radius: 16px;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.015),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
        }

        .coming-soon h3 {
            font-size: 1.5rem;
            color: #000000;
            margin-bottom: 10px;
        }

        .coming-soon p {
            color: rgba(0, 0, 0, 0.6);
            font-size: 1rem;
        }
        
        /* Styles pour les statistiques */
        .stats-filters {
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.015);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.04);
            border-radius: 16px;
        }
        
        .period-selector {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .period-btn {
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: #000000;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.9rem;
        }
        
        .period-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-1px);
        }
        
        .period-btn.active {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            padding: 24px;
            background: rgba(255, 255, 255, 0.02);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.015);
        }
        
        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }
        
        .stat-header h3 {
            font-size: 1rem;
            color: rgba(0, 0, 0, 0.7);
            margin: 0;
        }
        
        .stat-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            font-weight: bold;
        }
        
        .revenue-icon {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }
        
        .clients-icon {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
        }
        
        .appointments-icon {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            color: white;
        }
        
        .average-icon {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: #000000;
            margin-bottom: 8px;
            line-height: 1;
        }
        
        .stat-subtitle {
            font-size: 0.85rem;
            color: rgba(0, 0, 0, 0.6);
        }
        
        .stats-details {
            margin-top: 20px;
        }
        
        .details-card {
            padding: 24px;
            background: rgba(255, 255, 255, 0.02);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 16px;
        }
        
        .details-card h3 {
            margin: 0 0 20px 0;
            color: #000000;
            font-size: 1.1rem;
        }

        /* Styles pour les graphiques et nouvelles cartes */
        .stats-charts {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .chart-card {
            padding: 24px;
            background: rgba(255, 255, 255, 0.02);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.015);
        }

        .chart-card h3 {
            margin: 0 0 20px 0;
            color: #000000;
            font-size: 1.1rem;
        }

        .chart-container {
            position: relative;
            height: 200px;
            margin-bottom: 10px;
        }

        #revenueChart {
            width: 100% !important;
            height: 100% !important;
        }

        .services-stats {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .service-stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .service-name {
            font-weight: 500;
            color: #000000;
        }

        .service-count {
            font-weight: bold;
            color: #3b82f6;
        }

        /* Nouvelles icones pour les cartes */
        .clients-icon {
            background: linear-gradient(135deg, #10B981, #059669);
            color: white;
        }

        .avg-icon {
            background: linear-gradient(135deg, #8B5CF6, #7C3AED);
            color: white;
        }

        .appointments-icon {
            background: linear-gradient(135deg, #3B82F6, #2563EB);
            color: white;
        }

        .revenue-icon {
            background: linear-gradient(135deg, #F59E0B, #D97706);
            color: white;
        }
        
        .detail-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.06);
        }
        
        .detail-row:last-child {
            border-bottom: none;
        }
        
        .detail-row span:first-child {
            color: rgba(0, 0, 0, 0.7);
        }
        
        .detail-row span:last-child {
            font-weight: bold;
            color: #000000;
        }

        .date-navigation {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* Styles pour le nouvel agenda simplifi√© */
        .simple-agenda {
            background: rgba(255, 255, 255, 0.015);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.04);
            border-radius: 16px;
            padding: 20px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .agenda-day-header h3 {
            margin: 0 0 20px 0;
            color: #000000;
            text-align: center;
            font-size: 1.3rem;
        }
        
        .hours-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .hour-slot {
            display: flex;
            min-height: 60px;
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.02);
            transition: all 0.2s ease;
        }
        
        .hour-slot:hover {
            background: rgba(255, 255, 255, 0.04);
        }
        
        .hour-time {
            flex-shrink: 0;
            width: 70px;
            padding: 15px 10px;
            font-weight: bold;
            color: rgba(0, 0, 0, 0.7);
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px 0 0 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
        }
        
        .hour-content {
            flex: 1;
            padding: 10px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .hour-empty {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: rgba(0, 0, 0, 0.4);
            font-style: italic;
            transition: all 0.2s ease;
        }
        
        .hour-empty:hover {
            color: #3b82f6;
            background: rgba(245, 158, 11, 0.05);
        }
        
        .agenda-appointment {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
            border-left: 4px solid #6b7280;
        }
        
        .agenda-appointment.paid {
            border-left-color: #10b981;
            background: rgba(16, 185, 129, 0.05);
        }
        
        .agenda-appointment.unpaid {
            border-left-color: #f59e0b;
            background: rgba(245, 158, 11, 0.05);
        }
        
        .appointment-time {
            font-weight: bold;
            color: #000000;
            min-width: 50px;
            font-size: 0.85rem;
        }
        
        .appointment-details {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 2px;
        }
        
        .appointment-price {
            font-weight: bold;
            color: #10b981;
            font-size: 1rem;
        }
        
        .appointment-notes {
            color: rgba(0, 0, 0, 0.7);
            font-size: 0.85rem;
        }
        
        .appointment-actions {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .payment-toggle-mini {
            display: flex;
            align-items: center;
            cursor: pointer;
        }
        
        .payment-toggle-mini input {
            display: none;
        }
        
        .toggle-mini {
            width: 30px;
            height: 16px;
            background: #ccc;
            border-radius: 20px;
            position: relative;
            transition: all 0.2s ease;
        }
        
        .toggle-mini::after {
            content: '';
            position: absolute;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: white;
            top: 2px;
            left: 2px;
            transition: all 0.2s ease;
        }
        
        .payment-toggle-mini input:checked + .toggle-mini {
            background: #10b981;
        }
        
        .payment-toggle-mini input:checked + .toggle-mini::after {
            left: 16px;
        }
        
        .btn-edit-mini, .btn-delete-mini {
            width: 28px;
            height: 28px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            font-size: 0.8rem;
        }
        
        .btn-edit-mini {
            background: rgba(245, 158, 11, 0.1);
        }
        
        .btn-edit-mini:hover {
            background: rgba(245, 158, 11, 0.2);
        }
        
        .btn-delete-mini {
            background: rgba(239, 68, 68, 0.1);
        }
        
        .btn-delete-mini:hover {
            background: rgba(239, 68, 68, 0.2);
        }
        
        /* Agenda style Google Calendar */
        :root { --minute-px: 2; }
        .google-agenda {
            background: rgba(255, 255, 255, 0.015);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.04);
            border-radius: 16px;
            overflow: visible; /* int√©grer √† la page, pas de scroll interne */
            max-height: none;
        }
        
        .week-header {
            display: grid;
            grid-template-columns: 80px repeat(7, 1fr);
            background: rgba(255, 255, 255, 0.05);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .time-gutter {
            padding: 12px 8px;
            font-weight: bold;
            color: rgba(0, 0, 0, 0.6);
            text-align: center;
            font-size: 0.85rem;
            background: rgba(255, 255, 255, 0.02);
        }
        
        .day-header {
            padding: 12px 8px;
            text-align: center;
            border-left: 1px solid rgba(255, 255, 255, 0.06);
            transition: all 0.2s ease;
        }
        
        .day-header.today {
            background: transparent; /* pas de fond bleu plein */
            color: inherit; /* garder la couleur par d√©faut */
            border-bottom: 2px solid rgba(245, 158, 11, 0.35); /* soulignement subtil */
        }
        
        .day-name {
            font-size: 0.8rem;
            font-weight: bold;
            color: rgba(0, 0, 0, 0.7);
            margin-bottom: 2px;
        }
        
        .day-header.today .day-name {
            color: inherit; /* pas de for√ßage bleu */
        }
        
        .day-number {
            font-size: 1.2rem;
            font-weight: bold;
            color: #000000;
        }
        
        .day-header.today .day-number {
            color: #000000; /* garder le texte noir */
            background: transparent; /* supprimer le rond plein */
            border-radius: 0;
            width: auto;
            height: auto;
            display: inline; /* revenir √† un texte simple */
            position: relative;
        }

        /* underline sous le chiffre du jour supprim√© */
        
        .week-grid {
            overflow-y: visible; /* laisser la page scroller */
            max-height: none;
        }

        /* Minute grid (style Google Agenda) */
        .week-grid.minute-grid {
            display: grid;
            grid-template-columns: 80px repeat(7, 1fr);
            position: relative;
            user-select: none;
            -webkit-user-select: none;
        }

        .time-gutter-col {
            position: relative;
            height: calc(1440px * var(--minute-px)); /* 24h * 60min * minute height */
            background: rgba(255, 255, 255, 0.02);
            border-right: 1px solid rgba(255, 255, 255, 0.06);
        }

        .gutter-hour {
            position: absolute;
            left: 0;
            width: 100%;
            transform: translateY(-6px);
            font-size: 0.75rem;
            color: rgba(0,0,0,0.6);
            text-align: center;
        }

        .day-column {
            position: relative;
            height: calc(1440px * var(--minute-px)); /* minute height */
            border-left: 1px solid rgba(255, 255, 255, 0.06);
            background-image:
                /* ligne toutes les 30 min (beaucoup plus visible, 2px) */
                linear-gradient(to bottom, rgba(0,0,0,0.18) 2px, transparent 2px),
                /* ligne toutes les 60 min (tr√®s marqu√©e, 2px) */
                linear-gradient(to bottom, rgba(0,0,0,0.40) 2px, transparent 2px);
            background-size:
                100% calc(30px * var(--minute-px)),  /* 30 minutes */
                100% calc(60px * var(--minute-px));  /* 60 minutes */
            cursor: crosshair;
        }

        .day-column .hour-line {
            position: absolute;
            left: 0;
            right: 0;
            height: 1px;
            background: rgba(0,0,0,0.06);
        }

        .day-column .google-event {
            position: absolute;
            left: 4px;
            right: 4px;
            overflow: hidden;
        }

        .selection-block {
            position: absolute;
            left: 2px;
            right: 2px;
            background: rgba(59,130,246,0.15);
            border: 1px dashed rgba(59,130,246,0.9);
            border-radius: 6px;
            pointer-events: none;
        }

        .selection-block .selection-label {
            position: absolute;
            top: 4px;
            right: 6px;
            font-size: 11px;
            font-weight: 600;
            color: #1f2937;
            background: rgba(255,255,255,0.9);
            border: 1px solid rgba(0,0,0,0.06);
            border-radius: 10px;
            padding: 2px 6px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.04);
        }

        /* Indicateur d'heure sous la souris (avant s√©lection) */
        .hover-time-indicator {
            position: absolute;
            left: 6px;
            transform: translateY(-50%);
            font-size: 11px;
            font-weight: 600;
            color: #111827;
            background: rgba(255,255,255,0.95);
            border: 1px solid rgba(0,0,0,0.08);
            border-radius: 10px;
            padding: 2px 6px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.06);
            pointer-events: none;
        }
        
        .time-row {
            display: grid;
            grid-template-columns: 80px repeat(7, 1fr);
            min-height: 60px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.03);
        }
        
        .time-row:hover {
            background: rgba(255, 255, 255, 0.02);
        }
        
        .time-slot {
            padding: 8px;
            font-size: 0.8rem;
            color: rgba(0, 0, 0, 0.6);
            text-align: center;
            background: rgba(255, 255, 255, 0.02);
            border-right: 1px solid rgba(255, 255, 255, 0.06);
            display: flex;
            align-items: flex-start;
            justify-content: center;
            padding-top: 12px;
        }
        
        .day-cell {
            border-left: 1px solid rgba(255, 255, 255, 0.06);
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            padding: 4px;
        }
        
        .day-cell:hover {
            background: rgba(245, 158, 11, 0.05);
        }
        
        .google-event {
            /* Glassmorphism sombre par d√©faut */
            background: rgba(17, 25, 40, 0.75);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.12);
            color: white;
            padding: 6px 8px;
            margin: 2px 0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.8rem;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.18);
        }
        
        .google-event.paid {
            /* Noir/verre avec accent vert subtil pour l'√©tat pay√© */
            background: rgba(24, 24, 27, 0.9);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            border-color: rgba(16, 185, 129, 0.35);
            box-shadow:
                0 8px 24px rgba(16, 185, 129, 0.16),
                inset 0 0 0 1px rgba(16, 185, 129, 0.20);
        }
        
        .google-event.unpaid {
            /* Noir/verre pour les RDV non pay√©s / nouvellement ajout√©s */
            background: rgba(24, 24, 27, 0.82);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            border-color: rgba(255, 255, 255, 0.18);
        }
        
        .google-event:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .event-time {
            font-weight: bold;
            font-size: 0.75rem;
            margin-bottom: 2px;
        }
        
        .event-content {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }
        
        .event-price {
            font-weight: bold;
            font-size: 0.85rem;
        }
        
        .event-notes {
            font-size: 0.75rem;
            opacity: 0.9;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        /* Actions agenda: gauche (paiement) et droite (supprimer) */
        .event-actions-left,
        .event-actions-right {
            position: absolute;
            top: 4px;
            display: flex;
            align-items: center;
            gap: 6px;
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .event-actions-left { left: 4px; }
        .event-actions-right { right: 4px; }

        .google-event:hover .event-actions-left,
        .google-event:hover .event-actions-right {
            opacity: 1;
        }
        
        .payment-mini-toggle {
            display: flex;
            align-items: center;
            cursor: pointer;
        }
        
        .payment-mini-toggle input {
            display: none;
        }
        
        .mini-toggle {
            width: 30px;
            height: 16px;
            background: rgba(255, 255, 255, 0.32);
            border: 1px solid rgba(255,255,255,0.25);
            border-radius: 12px;
            position: relative;
            transition: all 0.2s ease;
            box-shadow: inset 0 1px 2px rgba(0,0,0,0.12);
            backdrop-filter: blur(6px);
            -webkit-backdrop-filter: blur(6px);
            overflow: hidden;
        }

        /* Effet d√©filement retir√© pour le mini toggle (retour √† l'ancien style) */
        .mini-toggle::before { content: none; }
        
        .mini-toggle::after {
            content: '';
            position: absolute;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: white;
            top: 2px;
            left: 2px;
            transition: all 0.2s ease;
            box-shadow: 0 1px 2px rgba(0,0,0,0.15);
        }
        
        .payment-mini-toggle input:checked + .mini-toggle {
            background: rgba(16, 185, 129, 0.3);
            border-color: rgba(16,185,129,0.45);
            box-shadow: inset 0 0 0 1px rgba(16,185,129,0.25);
        }
        
        .payment-mini-toggle input:checked + .mini-toggle::after {
            left: 16px;
            background: #eafff6;
        }

        .payment-mini-toggle input:checked + .mini-toggle::before {
            width: 100%;
        }

        /* Animation mini retir√©e */
        
        .btn-delete-event {
            width: 22px;
            height: 22px;
            border: 1px solid rgba(255, 59, 48, 0.35);
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.14); /* verre neutre */
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            color: rgba(255, 59, 48, 0.92); /* rouge pro */
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 800;
            box-shadow: 0 6px 18px rgba(255, 59, 48, 0.22);
            transition: all 0.2s ease;
        }
        
        .btn-delete-event:hover {
            border-color: rgba(255, 59, 48, 0.55);
            box-shadow: 0 10px 24px rgba(255, 59, 48, 0.3);
            transform: translateY(-1px) scale(1.06);
        }

        /* Bouton modifier retir√© de l'agenda */

        .nav-btn, .today-btn {
            background: rgba(255, 255, 255, 0.02);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.06);
            color: #000000;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s ease;
        }

        .add-btn {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: rgba(0, 0, 0, 0.8);
            padding: 12px 24px;
            border-radius: 16px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .nav-btn:hover, .today-btn:hover {
            background: rgba(255, 255, 255, 0.06);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.03);
        }

        .add-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: all 0.5s ease;
        }

        .add-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            border: 1px solid rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 
                0 12px 40px rgba(0, 0, 0, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.4);
        }

        .add-btn:hover::before {
            left: 100%;
        }

        .date-picker {
            background: rgba(255, 255, 255, 0.02);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.06);
            color: #000000;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 14px;
        }

        .view-toggle {
            display: flex;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 4px;
            backdrop-filter: blur(10px);
        }

        .toggle-btn {
            background: transparent;
            border: none;
            color: rgba(0, 0, 0, 0.6);
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .toggle-btn.active {
            background: rgba(255, 255, 255, 0.5);
            color: #000000;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .add-rdv-btn {
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #ffffff;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .add-rdv-btn:hover {
            background: rgba(30, 30, 30, 0.9);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        /* Styles pour la recherche avec ic√¥ne */
        .search-input-container { 
            position: relative; 
            flex: 1; 
        }
        
        .search-input-container .search-icon {
            position: absolute;
            left: 12px;
            top: 34%;
            transform: translateY(-50%);
            width: 18px;
            height: 18px;
            pointer-events: none;
            display: block;
            z-index: 10;
        }
        
        .search-input-container .search-input {
            box-sizing: border-box;
            height: 36px;
            line-height: 36px;
            padding-left: 40px;
            padding-right: 16px;
            width: 100%;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            color: #000000;
            font-size: 0.95rem;
            backdrop-filter: blur(10px);
        }

        .search-input::placeholder {
            color: rgba(0, 0, 0, 0.5);
            text-indent: 0;
        }

        .search-input:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.4);
        }

        .search-filters {
            padding: 20px;
            background: rgba(255, 255, 255, 0.015);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.04);
            border-radius: 16px;
            margin-bottom: 20px;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.015),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
        }

        .search-input {
            width: 100%;
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.06);
            color: #000000;
            padding: 12px 16px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 14px;
            backdrop-filter: blur(15px);
        }

        .search-input::placeholder {
            color: rgba(0, 0, 0, 0.5);
        }

        .filters {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .filter-select {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.06);
            color: #000000;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 14px;
            backdrop-filter: blur(15px);
        }

        .rdv-list {
            padding: 0;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            background: rgba(255, 255, 255, 0.015);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.04);
            border-radius: 16px;
            color: rgba(0, 0, 0, 0.8);
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.015),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
        }

        .empty-state h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: #000000;
        }
        
        .empty-state-message {
            text-align: center;
            padding: 60px 20px;
            background: rgba(255, 255, 255, 0.015);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.04);
            border-radius: 16px;
            margin: 20px 0;
        }
        
        .empty-state-message .empty-icon {
            font-size: 3rem;
            margin-bottom: 20px;
            opacity: 0.6;
        }
        
        .empty-state-message h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: #000000;
        }
        
        .empty-state-message p {
            color: rgba(0, 0, 0, 0.6);
            font-size: 0.9rem;
        }

        .rdv-card {
            background: rgba(255, 255, 255, 0.02);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 16px;
            padding: 20px;
            transition: all 0.3s ease;
            cursor: pointer;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.02),
                inset 0 1px 0 rgba(255, 255, 255, 0.08);
        }

        .rdv-card:hover {
            background: rgba(255, 255, 255, 0.04);
            transform: translateY(-8px);
            box-shadow: 
                0 15px 50px rgba(0, 0, 0, 0.04),
                inset 0 1px 0 rgba(255, 255, 255, 0.12);
        }

        .rdv-time {
            font-weight: 700;
            color: #000000;
            font-size: 1.2rem;
            margin-bottom: 8px;
        }

        .rdv-client {
            font-weight: 600;
            color: rgba(0, 0, 0, 0.8);
            margin: 8px 0 4px 0;
            font-size: 1.1rem;
        }

        .rdv-service {
            display: inline-block;
            background: #10B981;
            color: white;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 0.85rem;
            margin-right: 10px;
        }

        .rdv-price {
            font-weight: 600;
            color: #F59E0B !important;
        }

        .rdv-actions {
            display: flex;
            gap: 8px;
            margin-top: 12px;
            opacity: 0.7;
            transition: opacity 0.2s ease;
        }

        .rdv-card:hover .rdv-actions {
            opacity: 1;
        }

        .action-btn {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            color: #000000;
            padding: 8px 10px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s ease;
            font-weight: 600;
        }

        .action-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
        }

        .status-badge {
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .status-prevu { background: #6B7280; }
        .status-arrive { background: #F59E0B; }
        .status-encours { background: #F59E0B; }
        .status-termine { background: #10B981; }
        .status-annule { background: #EF4444; }
        .status-noshow { background: #7C2D12; }

        .payment-badge {
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .payment-unpaid { background: #F59E0B; color: white; }
        .payment-paid { background: #10B981; color: white; }
        .payment-comped { background: #8B5CF6; color: white; }

        /* Styles pour les cartes pay√©es/non pay√©es */
        .rdv-card.rdv-paid {
            border-left: 4px solid #10B981;
            background: rgba(16, 185, 129, 0.02);
        }

        .rdv-card.rdv-unpaid {
            border-left: 4px solid #EF4444;
            background: rgba(239, 68, 68, 0.02);
        }

        /* Styles pour les checkboxes de paiement */
        .payment-checkbox-container {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            user-select: none;
        }

        .payment-checkbox {
            display: none;
        }

        .payment-checkmark {
            width: 18px;
            height: 18px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 4px;
            position: relative;
            transition: all 0.2s ease;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }

        .payment-checkbox:checked + .payment-checkmark {
            background: #10B981;
            border-color: #10B981;
        }

        .payment-checkbox:checked + .payment-checkmark::after {
            content: '';
            position: absolute;
            left: 5px;
            top: 2px;
            width: 5px;
            height: 8px;
            border: solid white;
            border-width: 0 2px 2px 0;
            transform: rotate(45deg);
        }

        .payment-checkbox-label {
            font-size: 0.85rem;
            font-weight: 600;
            color: #000000;
            transition: color 0.2s ease;
        }

        .rdv-paid .payment-checkbox-label {
            color: #10B981;
        }

        .rdv-unpaid .payment-checkbox-label {
            color: #EF4444;
        }

        /* MOBILE FIRST - Interface optimis√©e mobile */
        
        /* Reset et base mobile */
        .timeline-view {
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        /* Nouveau design am√©lior√© */
        .page-title-center {
            text-align: center;
            margin-bottom: 10px;
        }
        
        .main-title {
            font-size: 2.5rem;
            font-weight: 800;
            color: #000000;
            margin: 0;
            letter-spacing: -0.5px;
        }
        
        .rdv-actions {
            display: flex;
            justify-content: center;
            margin-bottom: 10px;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .btn-nouveau-rdv {
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.25) 0%,
                rgba(255, 255, 255, 0.1) 50%,
                rgba(255, 255, 255, 0.2) 100%);
            backdrop-filter: blur(40px) saturate(180%);
            -webkit-backdrop-filter: blur(40px) saturate(180%);
            color: #000000;
            border: none;
            border-radius: 25px;
            padding: 15px 30px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.15),
                0 4px 16px rgba(0, 0, 0, 0.1),
                0 2px 8px rgba(0, 0, 0, 0.05),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }
        
        
        .btn-nouveau-rdv::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.1),
                rgba(255, 255, 255, 0.05),
                rgba(255, 255, 255, 0.08));
            border-radius: 25px;
            z-index: -1;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .btn-nouveau-rdv:hover {
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.35) 0%,
                rgba(255, 255, 255, 0.2) 50%,
                rgba(255, 255, 255, 0.3) 100%);
            backdrop-filter: blur(50px) saturate(200%);
            transform: translateY(-4px) scale(1.02);
            color: #000000;
            box-shadow: 
                0 20px 60px rgba(0, 0, 0, 0.3),
                0 15px 40px rgba(0, 0, 0, 0.2),
                0 8px 20px rgba(0, 0, 0, 0.15),
                0 4px 10px rgba(0, 0, 0, 0.1),
                inset 0 2px 0 rgba(255, 255, 255, 0.5),
                inset 0 -2px 0 rgba(0, 0, 0, 0.15),
                inset -2px 0 0 rgba(0, 0, 0, 0.1),
                inset 2px 0 0 rgba(0, 0, 0, 0.1);
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        
        .btn-nouveau-rdv:hover::after {
            opacity: 1;
        }
        
        .btn-nouveau-rdv:active {
            transform: translateY(-2px) scale(0.98);
            transition: all 0.1s ease;
        }


        /* Mode Vert - Classes pour remplacer l'orange */

        .green-mode .status-arrive { 
            background: #10B981 !important; 
        }

        .green-mode .status-encours { 
            background: #10B981 !important; 
        }

        .green-mode .payment-unpaid { 
            background: #10B981 !important; 
            color: white !important; 
        }

        .green-mode .price-badge {
            background: linear-gradient(180deg, #10B981, #059669) !important;
        }

        .green-mode .favorite-price {
            color: #10B981 !important;
        }

        .green-mode .favorite-price.active {
            border: 2px solid #10B981 !important;
            color: #10B981 !important;
        }

        /* Autres √©l√©ments orange √† changer */
        .green-mode .password-input:focus {
            border-color: rgba(16, 185, 129, 0.6) !important;
            box-shadow: 
                0 0 0 3px rgba(16, 185, 129, 0.15),
                0 4px 20px rgba(16, 185, 129, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.4) !important;
        }

        .green-mode .spinner {
            border-top: 3px solid #10B981 !important;
            border-right: 3px solid #059669 !important;
            filter: drop-shadow(0 0 10px rgba(16, 185, 129, 0.5)) !important;
        }

        .green-mode .password-toggle:hover {
            color: rgba(16, 185, 129, 0.8) !important;
        }
        
        .btn-clear-all {
            background: rgba(220, 38, 38, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            color: #ffffff;
            border: 1px solid rgba(220, 38, 38, 0.3);
            border-radius: 25px;
            padding: 15px 30px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 32px rgba(220, 38, 38, 0.4);
        }
        
        .btn-clear-all:hover {
            background: rgba(220, 38, 38, 1);
            backdrop-filter: blur(25px);
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(220, 38, 38, 0.6);
            border-color: rgba(220, 38, 38, 0.5);
        }
        
        .btn-icon {
            font-size: 1.3rem;
            font-weight: 300;
        }
        
        .date-today {
            background: transparent;
            border: none;
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            margin-bottom: 10px;
        }
        
        .date-label {
            display: block;
            font-size: 0.9rem;
            color: #666666;
            margin-bottom: 5px;
        }
        
        .date-value {
            font-size: 1.2rem;
            font-weight: 700;
            color: #000000;
        }
        
        .search-field {
            position: relative;
            margin-bottom: 15px;
        }

        .search-field .search-icon {
            position: absolute !important;
            left: 15px !important;
            top: 38% !important;
            transform: translateY(-50%) !important;
            width: 16px !important;
            height: 16px !important;
            color: #000000 !important;
            z-index: 2 !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
        }

        .search-input {
            width: 100%;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 25px;
            padding: 12px 18px 12px 45px;
            font-size: 1rem;
            color: #000000;
            min-height: 44px;
            box-sizing: border-box;
            outline: none;
        }

        .search-input::placeholder {
            color: rgba(0, 0, 0, 0.5);
        }

        .search-input:focus {
            border-color: rgba(0, 0, 0, 0.3);
            background: rgba(255, 255, 255, 0.12);
        }
        
        .search-input:focus {
            border-color: #000000;
            box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.1);
        }
        
        .search-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.2rem;
            color: #666666;
        }

        .timeline-container {
            padding: 10px;
        }

        /* Header mobile simple */
        .mobile-header {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 15px;
            margin-bottom: 15px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .date-display {
            text-align: center;
            font-size: 1.3rem;
            font-weight: 700;
            color: #000000;
        }

        .quick-actions {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .mobile-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.15);
            color: #000000;
            padding: 12px 20px;
            border-radius: 25px;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            min-height: 44px; /* Touch target */
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .mobile-btn:active {
            transform: scale(0.95);
            background: rgba(255, 255, 255, 0.2);
        }

        .mobile-btn.primary {
            background: rgba(0, 0, 0, 0.8);
            color: #ffffff;
        }

        /* Liste rendez-vous mobile optimis√©e */
        .appointments-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
            padding: 0 5px 20px 5px;
            max-height: 70vh;
            overflow-y: auto;
            flex: 1;
        }

        .appointment-card {
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.25);
            border-radius: 18px;
            padding: 16px;
            position: relative;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            overflow: hidden;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            box-sizing: border-box;
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            box-sizing: border-box;
        }
        
        .card-content {
            flex: 1;
            width: 100%;
            box-sizing: border-box;
        }
        
        .card-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            box-sizing: border-box;
            gap: 8px;
        }

        .appointment-card::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 5px;
            background: #000000;
            border-radius: 0 3px 3px 0;
        }

        .appointment-card.paid::before {
            background: linear-gradient(180deg, #10B981, #059669);
        }

        .appointment-card.unpaid::before {
            background: linear-gradient(180deg, #F59E0B, #D97706);
        }

        .appointment-card:active {
            transform: scale(0.98);
            background: rgba(255, 255, 255, 0.15);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
        }

        .time-badge {
            background: rgba(0, 0, 0, 0.1);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 700;
            color: #000000;
            text-align: center;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 65%;
            flex-shrink: 1;
        }

        .price-badge {
            background: rgba(255, 255, 255, 0.2);
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.85rem;
            font-weight: 600;
            color: #000000;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .card-content {
            flex: 1;
        }

        .appointment-notes-mobile {
            font-size: 0.9rem;
            color: rgba(0, 0, 0, 0.8);
            line-height: 1.4;
            margin-bottom: 8px;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            word-wrap: break-word;
        }

        .card-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 12px;
            z-index: 10;
            position: relative;
        }

        .status-mobile {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.85rem;
            font-weight: 600;
            color: #000000;
            flex-shrink: 1;
            min-width: 0;
        }

        /* Bouton toggle de paiement */

        /* Bouton de coche */
        .check-btn {
            background: rgba(16, 185, 129, 0.1) !important;
            color: #10B981 !important;
            font-size: 16px !important;
            font-weight: bold !important;
        }

        .check-btn:hover {
            background: rgba(16, 185, 129, 0.2) !important;
        }

        /* Bouton checkbox toggle couleur */

        /* Nouveau bouton supprimer */
        .remove-rdv-btn {
            background: transparent;
            color: #EF4444;
            border: none;
            border-radius: 4px;
            padding: 4px 8px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .remove-rdv-btn:hover {
            background: transparent;
            transform: scale(1.2);
        }

        /* Section prix avec bouton supprimer en dessous */
        .price-section {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 4px;
        }

        .price-section .delete-btn {
            margin-left: 0;
        }

        /* Styles pour les statistiques */
        .stats-period-selector {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin: 20px 16px;
            flex-wrap: wrap;
        }

        .period-btn {
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.25);
            border-radius: 12px;
            padding: 8px 16px;
            color: #000;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 12px;
            font-weight: 500;
        }

        .period-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            border-color: rgba(255, 255, 255, 0.4);
        }

        .period-btn.active {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
            color: #000;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.1);
        }

        .stats-cards-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin: 20px 16px;
        }

        .stats-card {
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.25);
            border-radius: 18px;
            padding: 20px 16px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            min-height: 100px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .stats-card:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .stats-value {
            font-size: 24px;
            font-weight: 700;
            color: #000;
            margin-bottom: 8px;
            line-height: 1;
        }

        .stats-label {
            font-size: 12px;
            color: #000;
            font-weight: 500;
            opacity: 0.8;
        }

        @media (max-width: 480px) {
            .stats-cards-container {
                grid-template-columns: 1fr;
                gap: 12px;
                margin: 16px 12px;
            }
            
            .stats-card {
                padding: 16px 12px;
                min-height: 80px;
            }
            
            .stats-value {
                font-size: 22px;
            }
            
            .stats-label {
                font-size: 11px;
            }
        }

        /* Bouton de paiement */
        .payment-check-btn {
            width: 28px;
            height: 28px;
            border: none;
            background: transparent;
            cursor: pointer;
            padding: 0;
            transition: all 0.3s ease;
        }

        .check-circle {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            border: 2px solid rgba(255, 255, 255, 0.4);
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            color: transparent;
        }

        .payment-check-btn:hover .check-circle {
            border-color: #10B981;
            background: rgba(16, 185, 129, 0.1);
            transform: scale(1.1);
        }

        .payment-check-btn.checked .check-circle {
            border-color: #10B981;
            background: #10B981;
            color: white;
        }

        .payment-check-btn.checked:hover .check-circle {
            background: #059669;
            transform: scale(1.1);
        }
            background: rgba(245, 158, 11, 0.1);
        }

        .video-btn.green-active:hover {
            background: #059669;
            border-color: #059669;
        }

        /* Classe pour l'√©tat pay√© (ancien comportement) */
        .video-btn.paid {
            border-color: #10B981;
            color: #10B981;
            background: rgba(16, 185, 129, 0.1);
        }

        .card-actions {
            display: flex;
            gap: 6px;
            flex-shrink: 0;
            align-items: center;
        }

        .action-btn-mobile {
            width: 36px;
            height: 36px;
            border-radius: 10px;
            border: none;
            background: rgba(255, 255, 255, 0.9);
            color: rgba(0, 0, 0, 0.8);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            font-size: 14px;
            flex-shrink: 0;
            box-sizing: border-box;
        }

        .action-btn-mobile:active {
            transform: scale(0.9);
            background: rgba(255, 255, 255, 0.2);
        }

        .action-btn-mobile.delete {
            background: rgba(255, 255, 255, 0.9);
            color: #EF4444;
        }

        .action-btn-mobile.delete:active {
            background: rgba(239, 68, 68, 0.1);
        }

        .action-btn-mobile.status-btn.paid {
            background: rgba(255, 255, 255, 0.9);
            color: #10B981;
        }

        .action-btn-mobile.status-btn.unpaid {
            background: rgba(255, 255, 255, 0.9);
            color: #10B981;
        }

        .action-btn-mobile.status-btn:active {
            background: rgba(16, 185, 129, 0.1);
        }

        .client-info {
            margin-bottom: 8px;
        }

        .service-info {
            font-size: 0.9rem;
            color: rgba(0, 0, 0, 0.6);
            margin-top: 4px;
        }

        /* Nouvelle structure int√©gr√©e */
        .rdv-info-line {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
            padding-top: 12px;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
        }

        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-size: 0.85rem;
            font-weight: 600;
            padding: 4px 10px;
            border-radius: 15px;
            background: rgba(0, 0, 0, 0.05);
            color: #000000;
        }

        .status-badge.paid {
            background: rgba(16, 185, 129, 0.1);
            color: #10B981;
        }

        .status-badge.unpaid {
            background: rgba(245, 158, 11, 0.1);
            color: #F59E0B;
        }

        .rdv-actions {
            display: flex;
            gap: 6px;
        }

        .rdv-btn {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            border: none;
            background: rgba(0, 0, 0, 0.05);
            color: #000000;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            font-size: 14px;
        }

        .rdv-btn:hover {
            background: rgba(0, 0, 0, 0.1);
            transform: scale(1.05);
        }

        .rdv-btn:active {
            transform: scale(0.95);
        }

        .rdv-btn.delete {
            color: #EF4444;
        }

        .rdv-btn.delete:hover {
            background: rgba(239, 68, 68, 0.1);
        }

        .rdv-btn.status-btn.paid {
            color: #10B981;
        }

        .rdv-btn.status-btn.unpaid {
            color: #F59E0B;
        }

        /* Navigation par jours */
        .date-navigation {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .nav-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: rgba(255, 255, 255, 0.1);
            color: #000000;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .nav-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }

        .nav-btn:active {
            transform: scale(0.95);
        }

        /* Search mobile */
        .search-mobile {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 25px;
            padding: 12px 18px;
            font-size: 1rem;
            color: #000000;
            width: 100%;
            margin-bottom: 15px;
            backdrop-filter: blur(10px);
            min-height: 44px;
        }

        .search-mobile::placeholder {
            color: rgba(0, 0, 0, 0.5);
        }

        .search-mobile:focus {
            outline: none;
            border-color: rgba(0, 0, 0, 0.3);
            background: rgba(255, 255, 255, 0.12);
        }

        /* Empty state mobile */
        .empty-state-mobile {
            text-align: center;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            margin-top: 15px;
            margin-bottom: 20px;
            position: relative;
            z-index: 10;
        }

        .empty-state-mobile h3 {
            font-size: 1.3rem;
            color: #000000;
            margin-bottom: 10px;
        }

        .empty-state-mobile p {
            color: rgba(0, 0, 0, 0.6);
            font-size: 1rem;
        }

        /* Syst√®me de swipe horizontal */
        .admin-container {
            position: relative;
            overflow: hidden;
        }

        .timeline-view, .stats-view {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            background: transparent;
        }

        .timeline-view {
            transform: translateX(0);
        }

        .stats-view {
            transform: translateX(-100%);
        }

        /* √âtats actifs */
        .admin-container.show-stats .timeline-view {
            transform: translateX(100%);
        }
        .admin-container.show-stats .stats-view {
            transform: translateX(0);
        }

        /* Statistiques Noir et Blanc */
        .stats-black-container {
            background: #000000;
            color: #ffffff;
            min-height: 100vh;
            padding: 20px;
            font-family: 'Inter', sans-serif;
        }

        .stats-header-black {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #ffffff;
            padding-bottom: 20px;
        }

        .stats-title-black {
            font-size: 2rem;
            font-weight: 700;
            color: #ffffff;
            margin: 0;
            letter-spacing: -0.5px;
        }

        .stats-filters-black {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
        }

        .period-selector-black {
            display: flex;
            gap: 8px;
            background: #ffffff;
            padding: 4px;
            border-radius: 12px;
        }

        .period-btn-black {
            padding: 12px 20px;
            border: none;
            background: transparent;
            color: #000000;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.9rem;
        }

        .period-btn-black:hover {
            background: #f3f4f6;
        }

        .period-btn-black.active {
            background: #000000;
            color: #ffffff;
        }

        .paid-summary-black {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .paid-summary-item {
            background: #ffffff;
            color: #000000;
            padding: 30px;
            border-radius: 12px;
            text-align: center;
            border: 2px solid #000000;
        }

        .paid-summary-number {
            font-size: 3rem;
            font-weight: 800;
            color: #000000;
            margin-bottom: 8px;
            font-family: 'Inter', monospace;
        }

        .paid-summary-label {
            font-size: 1.1rem;
            font-weight: 500;
            color: #666666;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .chart-black-container {
            background: #ffffff;
            border: 3px solid #000000;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .chart-black-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #000000;
            padding-bottom: 15px;
        }

        .chart-black-header h3 {
            font-size: 1.5rem;
            font-weight: 700;
            color: #000000;
            margin: 0;
        }

        .chart-period-info {
            font-size: 1rem;
            color: #666666;
            font-weight: 500;
        }

        .chart-black-canvas {
            background: #ffffff;
            border: 1px solid #e5e5e5;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .chart-legend-black {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 15px;
        }

        .legend-item-black {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
            color: #000000;
        }

        .legend-dot-black {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #000000;
            border: 2px solid #ffffff;
        }

        .legend-line-black {
            width: 20px;
            height: 3px;
            background: #666666;
            border-radius: 2px;
        }

        .recent-paid-list {
            background: #ffffff;
            border: 3px solid #000000;
            border-radius: 16px;
            padding: 30px;
        }

        .recent-paid-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #000000;
            margin-bottom: 20px;
            border-bottom: 2px solid #000000;
            padding-bottom: 10px;
        }

        .recent-paid-items {
            display: grid;
            gap: 12px;
        }

        .recent-paid-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: #f9f9f9;
            border: 1px solid #e5e5e5;
            border-radius: 8px;
        }

        .recent-paid-info {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .recent-paid-client {
            font-weight: 600;
            color: #000000;
            font-size: 1.1rem;
        }

        .recent-paid-date {
            font-size: 0.9rem;
            color: #666666;
        }

        .recent-paid-amount {
            font-size: 1.2rem;
            font-weight: 700;
            color: #000000;
            font-family: 'Inter', monospace;
        }

        @media (max-width: 768px) {
            .stats-black-container {
                padding: 15px;
            }
            
            .stats-title-black {
                font-size: 1.5rem;
            }
            
            .period-selector-black {
                flex-wrap: wrap;
            }
            
            .period-btn-black {
                padding: 10px 16px;
                font-size: 0.8rem;
            }
            
            .paid-summary-number {
                font-size: 2rem;
            }
            
            .chart-black-container, .recent-paid-list {
                padding: 20px;
            }
            
            .chart-legend-black {
                flex-direction: column;
                gap: 10px;
            }
        }

        /* Indicateurs de swipe */
        .swipe-indicators {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 8px;
            z-index: 200;
        }


        /* Animations mobiles */
        .appointment-card {
            opacity: 0;
            transform: translateY(30px);
            animation: slideInMobile 0.5s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }

        .appointment-card:nth-child(1) { animation-delay: 0.1s; }
        .appointment-card:nth-child(2) { animation-delay: 0.15s; }
        .appointment-card:nth-child(3) { animation-delay: 0.2s; }
        .appointment-card:nth-child(4) { animation-delay: 0.25s; }
        .appointment-card:nth-child(5) { animation-delay: 0.3s; }

        @keyframes slideInMobile {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Safe area pour iPhone */
        .timeline-container {
            padding-bottom: 60px;
        }

        /* Masquer l'ancienne interface sur mobile */
        @media (max-width: 768px) {
            .top-nav {
                display: none;
            }
            
            .page-header {
                display: none;
            }
            
            .search-filters {
                display: none;
            }
            
            .timeline-grid {
                display: none;
            }
        }

        /* Styles pour les checkboxes dans l'agenda */
        .agenda-payment-checkbox {
            display: flex;
            align-items: center;
            gap: 4px;
            cursor: pointer;
            user-select: none;
        }

        .agenda-checkmark {
            width: 14px;
            height: 14px;
            border: 1px solid rgba(255, 255, 255, 0.4);
            border-radius: 3px;
        }

        .agenda-payment-text {
            font-size: 0.7rem;
            font-weight: 500;
            color: rgba(0, 0, 0, 0.8);
        }

        .appointment-item.paid .agenda-payment-text {
            color: #10B981;
        }

        .appointment-item.unpaid .agenda-payment-text {
            color: #EF4444;
        }

        .action-edit {
            background: rgba(245, 158, 11, 0.1) !important;
            border-color: rgba(245, 158, 11, 0.2) !important;
            color: #F59E0B !important;
        }

        .action-edit:hover {
            background: rgba(245, 158, 11, 0.2) !important;
            border-color: rgba(245, 158, 11, 0.3) !important;
        }

        .action-duplicate {
            background: rgba(16, 185, 129, 0.1) !important;
            border-color: rgba(16, 185, 129, 0.2) !important;
            color: #10B981 !important;
        }

        .action-duplicate:hover {
            background: rgba(16, 185, 129, 0.2) !important;
            border-color: rgba(16, 185, 129, 0.3) !important;
        }

        .action-delete {
            background: rgba(239, 68, 68, 0.1) !important;
            border-color: rgba(239, 68, 68, 0.2) !important;
            color: #EF4444 !important;
        }

        .action-delete:hover {
            background: rgba(239, 68, 68, 0.2) !important;
            border-color: rgba(239, 68, 68, 0.3) !important;
        }

        /* Nouveau design moderne pour les cartes de rendez-vous */
        .rdv-card-modern {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 16px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 4px 20px rgba(0, 0, 0, 0.05),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
        }

        .rdv-card-modern::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            transition: all 0.3s ease;
        }

        .rdv-card-modern.rdv-paid {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 
                0 4px 20px rgba(0, 0, 0, 0.06),
                inset 0 1px 0 rgba(255, 255, 255, 0.15);
        }

        .rdv-card-modern.rdv-paid::before {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.08), rgba(255, 255, 255, 0.03));
        }

        .rdv-card-modern.rdv-paid:hover {
            background: rgba(255, 255, 255, 0.12);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 
                0 6px 30px rgba(0, 0, 0, 0.08),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }

        .rdv-card-modern.rdv-unpaid {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 
                0 2px 15px rgba(0, 0, 0, 0.03),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
        }

        .rdv-card-modern.rdv-unpaid::before {
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.02), rgba(0, 0, 0, 0.01));
        }

        .rdv-card-modern.rdv-unpaid:hover {
            background: rgba(255, 255, 255, 0.06);
            border: 1px solid rgba(255, 255, 255, 0.12);
            box-shadow: 
                0 4px 20px rgba(0, 0, 0, 0.05),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .rdv-card-modern:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }

        .rdv-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .rdv-time-display {
            display: flex;
            align-items: baseline;
            gap: 2px;
            font-weight: 700;
            font-size: 1.8rem;
            color: #1f2937;
        }

        .time-hour {
            font-size: 2rem;
        }

        .time-separator {
            font-size: 1.8rem;
            opacity: 0.5;
        }

        .time-minute {
            font-size: 1.8rem;
        }

        .rdv-price-display {
            display: flex;
            align-items: baseline;
            gap: 2px;
            background: linear-gradient(135deg, #F59E0B, #1D4ED8);
            color: white;
            padding: 8px 16px;
            border-radius: 12px;
            font-weight: 600;
            box-shadow: 0 2px 8px rgba(245, 158, 11, 0.2);
        }

        .price-amount {
            font-size: 1.3rem;
            color: #000000 !important; /* Force la couleur noire, jamais verte */
        }

        .rdv-price {
            font-weight: 600;
            color: #F59E0B !important; /* Force la couleur orange, jamais verte */
        }

        /* FORCE: Le prix ne doit JAMAIS changer de couleur */
        .rdv-card-modern .price-amount,
        .rdv-card .price-amount,
        .rdv-paid .price-amount,
        .rdv-unpaid .price-amount,
        div[class*="rdv"] .price-amount,
        div[class*="paid"] .price-amount {
            color: #000000 !important;
        }

        .rdv-card-modern .rdv-price,
        .rdv-card .rdv-price,
        .rdv-paid .rdv-price,
        .rdv-unpaid .rdv-price,
        div[class*="rdv"] .rdv-price,
        div[class*="paid"] .rdv-price {
            color: #F59E0B !important;
        }

        .price-currency {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .rdv-content {
            margin-bottom: 16px;
        }

        .rdv-notes-modern {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(15px);
            padding: 12px 16px;
            border-radius: 12px;
            margin-bottom: 12px;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .notes-icon {
            font-size: 1.1rem;
        }

        .notes-text {
            font-size: 0.9rem;
            color: rgba(0, 0, 0, 0.7);
            line-height: 1.4;
        }

        .rdv-payment-row {
            display: flex;
            align-items: center;
            justify-content: flex-start;
        }

        .payment-switch {
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            user-select: none;
        }

        .payment-checkbox-modern {
            display: none;
        }

        .payment-slider {
            position: relative;
            width: 50px;
            height: 26px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 26px;
            transition: all 0.3s ease;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
            overflow: hidden;
        }

        .payment-slider::before {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            left: 3px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transition: transform 200ms cubic-bezier(0.25, 0.8, 0.25, 1), box-shadow 200ms ease;
            box-shadow: 
                0 2px 8px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.5);
        }

        /* Effet d√©filement retir√© (retour √† l'ancien style) */
        .payment-slider::after { content: none; }

        .payment-checkbox-modern:checked + .payment-slider {
            background: rgba(16, 185, 129, 0.2);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 1px solid rgba(16, 185, 129, 0.3);
            box-shadow:
                0 2px 8px rgba(16, 185, 129, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }

        .payment-checkbox-modern:checked + .payment-slider::before {
            transform: translateX(26px) translateY(-50%);
        }

        /* retour style: pas de d√©filement */

        @keyframes payGlow {
            0% { box-shadow: 0 0 0 0 rgba(16,185,129,0.35), inset 0 1px 0 rgba(255,255,255,0.2); }
            70% { box-shadow: 0 0 0 8px rgba(16,185,129,0); }
            100% { box-shadow: 0 2px 8px rgba(16,185,129,0.2), inset 0 1px 0 rgba(255,255,255,0.2); }
        }

        .payment-label {
            font-size: 0.9rem;
            font-weight: 500;
            color: #6B7280;
            transition: color 0.3s ease;
        }

        .rdv-card-modern.rdv-paid .payment-label {
            color: rgba(0, 0, 0, 0.8);
            font-weight: 600;
        }

        .rdv-card-modern.rdv-unpaid .payment-label {
            color: rgba(0, 0, 0, 0.6);
            font-weight: 500;
        }

        .rdv-actions-modern {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .btn-modern {
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            font-size: 16px;
        }

        .btn-edit {
            background: rgba(245, 158, 11, 0.1);
            color: #F59E0B;
        }

        .btn-edit:hover {
            background: rgba(245, 158, 11, 0.2);
            transform: scale(1.05);
        }

        .btn-duplicate {
            background: rgba(16, 185, 129, 0.1);
            color: #10B981;
        }

        .btn-duplicate:hover {
            background: rgba(16, 185, 129, 0.2);
            transform: scale(1.05);
        }

        .btn-delete {
            background: rgba(239, 68, 68, 0.1);
            color: #EF4444;
        }

        .btn-delete:hover {
            background: rgba(239, 68, 68, 0.2);
            transform: scale(1.05);
        }

        /* S√©parateur de date */
        .date-separator {
            font-size: 1.1rem;
            font-weight: 600;
            color: rgba(0, 0, 0, 0.8);
            margin: 24px 0 16px 0;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.06);
            backdrop-filter: blur(20px);
            border-radius: 12px;
            border-left: 4px solid rgba(245, 158, 11, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.12);
            text-transform: capitalize;
            box-shadow: 
                0 2px 15px rgba(0, 0, 0, 0.03),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .rdv-phone {
            font-size: 0.85rem;
            color: rgba(0, 0, 0, 0.6);
            margin: 4px 0;
        }

        .rdv-notes {
            font-size: 0.85rem;
            color: rgba(0, 0, 0, 0.6);
            font-style: italic;
            margin: 4px 0;
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 24px;
            max-width: 750px;
            width: 95%;
            max-height: 95vh;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            transform: translateY(30px) scale(0.9);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 15px 35px rgba(0, 0, 0, 0.06),
                0 5px 15px rgba(0, 0, 0, 0.03),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }

        .modal-overlay.show .modal {
            transform: translateY(0) scale(1);
        }

        .modal-header {
            padding: 35px 40px 25px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: center;
            align-items: center;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 24px 24px 0 0;
            position: relative;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #000000;
            margin: 0;
            text-align: center;
            width: 100%;
        }

        .modal-close {
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            color: rgba(0, 0, 0, 0.7);
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-50%) scale(1.1);
        }

        .modal-form {
            padding: 40px 50px;
            overflow-y: auto;
            flex: 1;
        }
        
        /* Restaurer l'espacement pour les √©l√©ments de formulaire */
        .modal * {
            margin: revert;
            padding: revert;
        }
        
        .modal .form-group {
            margin: 0 0 25px 0;
            padding: 0;
        }
        
        .modal .form-row {
            margin: 0 0 24px 0;
            padding: 0;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-bottom: 24px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
        }

        .form-group label {
            font-weight: 600;
            color: rgba(0, 0, 0, 0.8);
            font-size: 0.9rem;
            text-align: center;
            width: 100%;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 14px 18px;
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 14px;
            color: rgba(0, 0, 0, 0.9);
            font-size: 0.95rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.03);
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: rgba(245, 158, 11, 0.6);
            background: rgba(255, 255, 255, 0.3);
            box-shadow: 
                0 0 0 4px rgba(245, 158, 11, 0.15),
                0 4px 12px rgba(0, 0, 0, 0.1);
            transform: translateY(-1px);
        }

        .form-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            margin-top: 32px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .btn-cancel {
            padding: 16px 32px;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.25);
            border-radius: 14px;
            color: rgba(0, 0, 0, 0.8);
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .btn-cancel:hover {
            background: rgba(255, 255, 255, 0.25);
            border-color: rgba(255, 255, 255, 0.35);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .btn-save {
            padding: 16px 32px;
            background: linear-gradient(135deg, #10B981, #059669);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(16, 185, 129, 0.4);
            border-radius: 14px;
            color: white;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 6px 20px rgba(16, 185, 129, 0.3),
                0 2px 8px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }

        .btn-save::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: all 0.5s ease;
        }

        .btn-save:hover {
            background: linear-gradient(135deg, #059669, #047857);
            transform: translateY(-2px);
            box-shadow: 
                0 8px 25px rgba(16, 185, 129, 0.4),
                0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .btn-save:hover::before {
            left: 100%;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .form-actions {
                flex-direction: column;
            }
        }

        @media (max-width: 768px) {
            .admin-panel {
                padding: 10px;
            }
            
            .admin-container {
                min-height: calc(100vh - 20px);
                border-radius: 16px;
            }
            
            .top-nav {
                flex-direction: column;
                gap: 15px;
                align-items: stretch;
                border-radius: 16px 16px 0 0;
            }
            
            .nav-menu {
                gap: 8px;
                overflow-x: auto;
                justify-content: flex-start;
                padding-bottom: 5px;
            }
            
            .nav-item {
                flex-shrink: 0;
                min-width: 100px;
                font-size: 0.85rem;
                padding: 8px 12px;
            }
            
            .nav-icon {
                font-size: 1rem;
            }
            
            .nav-label {
                font-size: 0.8rem;
            }
            
            .logout-btn-top {
                align-self: center;
                min-width: 140px;
                justify-content: center;
            }
            
            .page-header {
                flex-direction: column;
                align-items: stretch;
            }
            
            .page-actions {
                justify-content: center;
                flex-wrap: wrap;
            }
            
            .date-navigation {
                justify-content: center;
                flex-wrap: wrap;
            }
            
            .filters {
                flex-direction: column;
            }
            
            .filter-select {
                width: 100%;
            }
        }

        /* Styles pour le syst√®me de prix */
        .price-control {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 15px;
        }

        .price-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            color: #000000;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .price-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .price-btn:active {
            transform: translateY(0);
        }

        .price-favorites {
            margin-top: 15px;
        }

        .price-quick-buttons {
            display: flex;
            gap: 8px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .price-quick-btn {
            padding: 8px 16px;
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            color: #000000;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .price-quick-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-1px);
        }

        .price-quick-btn.active {
            background: rgba(16, 185, 129, 0.8);
            color: white;
            border-color: rgba(16, 185, 129, 0.9);
        }

        /* Styles dur√©e align√©s sur "prix" */
        .duration-control {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 15px;
        }

        .duration-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            color: #000000;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .duration-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .btn-save-duration {
            padding: 8px 16px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(245, 158, 11, 0.8);
            backdrop-filter: blur(10px);
            color: white;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.85rem;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-save-duration:hover {
            background: rgba(245, 158, 11, 0.95);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .duration-custom-favorites .custom-duration-btn {
            padding: 8px 16px;
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            color: #000000;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.9rem;
            font-weight: 500;
            margin: 4px;
            position: relative;
        }

        .duration-custom-favorites .custom-duration-btn:hover {
            background: rgba(255, 255, 255, 0.25);
        }

        .duration-custom-favorites .custom-duration-btn.active {
            background: rgba(16, 185, 129, 0.8);
            color: #fff;
            border-color: rgba(16,185,129,0.9);
        }

        .duration-custom-favorites .custom-duration-btn .remove-duration {
            position: absolute;
            top: -5px;
            right: -5px;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: rgba(239, 68, 68, 0.8);
            color: white;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            cursor: pointer;
            opacity: 0;
            transition: all 0.2s ease;
        }

        .duration-custom-favorites .custom-duration-btn:hover .remove-duration {
            opacity: 1;
        }

        .price-custom-favorites {
            margin-bottom: 15px;
        }

        .custom-price-btn {
            padding: 8px 16px;
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            color: #000000;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.9rem;
            font-weight: 500;
            margin: 4px;
            position: relative;
        }

        .custom-price-btn:hover {
            background: rgba(255, 255, 255, 0.25);
        }

        .custom-price-btn .remove-price {
            position: absolute;
            top: -5px;
            right: -5px;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: rgba(239, 68, 68, 0.8);
            color: white;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            cursor: pointer;
            opacity: 0;
            transition: all 0.2s ease;
        }

        .custom-price-btn:hover .remove-price {
            opacity: 1;
        }

        .btn-save-price {
            padding: 8px 16px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: #000000;
            backdrop-filter: blur(10px);
            color: white;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.85rem;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-save-price:hover {
            background: #333333;
            transform: translateY(-1px);
        }

        /* Styles pour la checkbox */
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 0;
        }

        .checkbox-input {
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 4px;
            cursor: pointer;
            position: relative;
            appearance: none;
            -webkit-appearance: none;
            transition: all 0.2s ease;
        }

        .checkbox-input:checked {
            background: rgba(16, 185, 129, 0.8);
            border-color: rgba(16, 185, 129, 0.9);
        }

        .checkbox-input:checked::after {
            content: '‚úì';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 12px;
            font-weight: bold;
        }

        .checkbox-input:hover {
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-1px);
        }

        .checkbox-label {
            font-size: 0.95rem;
            font-weight: 500;
            color: #000000;
            cursor: pointer;
            user-select: none;
        }

        @media (max-width: 768px) {
            .price-quick-buttons {
                gap: 6px;
            }
            
            .price-quick-btn {
                padding: 6px 12px;
                font-size: 0.8rem;
            }
            
            .price-btn {
                width: 36px;
                height: 36px;
            }
            
            .checkbox-input {
                width: 18px;
                height: 18px;
            }
            
            .checkbox-label {
                font-size: 0.9rem;
            }
        }

        /* Styles pour l'agenda */
        .agenda-view {
            width: 100%;
            overflow: hidden;
        }

        .agenda-calendar {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .calendar-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding: 0 20px;
        }

        .calendar-nav {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            color: #000000;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: all 0.2s ease;
        }

        .calendar-nav:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .calendar-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #000000;
        }

        .agenda-header {
            display: grid;
            grid-template-columns: 80px repeat(7, 1fr);
            gap: 1px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px 8px 0 0;
            overflow: hidden;
        }

        .time-column {
            background: rgba(255, 255, 255, 0.15);
            padding: 15px 10px;
            text-align: center;
            font-weight: 600;
            font-size: 0.9rem;
            color: #000000;
        }

        .day-column {
            background: rgba(255, 255, 255, 0.15);
            padding: 15px 10px;
            text-align: center;
            color: #000000;
        }

        .day-column.today {
            background: rgba(16, 185, 129, 0.3);
            color: #000000;
        }

        .day-name {
            font-weight: 600;
            font-size: 0.9rem;
        }

        .day-date {
            font-size: 1.2rem;
            font-weight: 700;
            margin-top: 5px;
        }

        .agenda-body {
            max-height: 600px;
            overflow-y: auto;
        }

        .time-row {
            display: grid;
            grid-template-columns: 80px repeat(7, 1fr);
            gap: 1px;
            background: rgba(255, 255, 255, 0.05);
        }

        .time-cell {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px;
            text-align: center;
            font-size: 0.85rem;
            color: rgba(0, 0, 0, 0.7);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
        }

        .appointment-cell {
            background: rgba(255, 255, 255, 0.05);
            min-height: 40px;
            padding: 2px;
            position: relative;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .appointment-cell:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .appointment-item {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            padding: 8px;
            margin: 2px;
            border-left: 4px solid;
            position: relative;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .appointment-item.paid {
            border-left-color: rgba(16, 185, 129, 0.8);
            background: rgba(16, 185, 129, 0.1);
        }

        .appointment-item.unpaid {
            border-left-color: rgba(239, 68, 68, 0.8);
            background: rgba(239, 68, 68, 0.1);
        }

        .appointment-item:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .appointment-time {
            font-size: 0.75rem;
            font-weight: 600;
            color: #000000;
        }

        .appointment-price {
            font-size: 0.9rem;
            font-weight: 700;
            color: #000000;
            margin: 2px 0;
        }

        .appointment-payment {
            font-size: 0.8rem;
            font-weight: 600;
        }

        .appointment-payment.paid {
            color: rgba(16, 185, 129, 0.9);
        }

        .appointment-payment.unpaid {
            color: rgba(239, 68, 68, 0.9);
        }

        .appointment-notes {
            font-size: 0.7rem;
            color: rgba(0, 0, 0, 0.7);
            margin-top: 4px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .appointment-actions {
            position: absolute;
            top: 2px;
            right: 2px;
            display: flex;
            gap: 2px;
            opacity: 0.6;
            transition: all 0.2s ease;
        }

        .appointment-item:hover .appointment-actions {
            opacity: 1;
        }

        .edit-btn, .delete-btn {
            width: 20px;
            height: 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            transition: all 0.2s ease;
        }

        .edit-btn {
            background: rgba(245, 158, 11, 0.8);
        }

        .delete-btn {
            background: rgba(239, 68, 68, 0.8);
        }

        .edit-btn:hover, .delete-btn:hover {
            transform: scale(1.1);
        }

        @media (max-width: 768px) {
            .agenda-header, .time-row {
                grid-template-columns: 60px repeat(7, 1fr);
            }
            
            .time-column, .time-cell {
                font-size: 0.75rem;
                padding: 8px 5px;
            }
            
            .day-column {
                padding: 10px 5px;
            }
            
            .day-name {
                font-size: 0.7rem;
            }
            
            .day-date {
                font-size: 1rem;
            }
            
            .appointment-item {
                padding: 6px;
            }
            
            .appointment-time, .appointment-price {
                font-size: 0.7rem;
            }
        }
    </style>
</head>
<body>
    
    <div class="container" id="loginContainer">
        <div class="login-card" id="loginCard">
            <!-- <h1 class="title">COIFFEUR<br>PRO</h1> -->
            <!-- <p class="subtitle">ESPACE ADMINISTRATION PRIV√â</p> -->
            
            <button class="admin-btn" id="adminBtn">
                ACC√àS ADMINISTRATION
            </button>
            
            <div class="password-form" id="passwordForm">
                <div class="password-input-container">
                    <input 
                        type="password" 
                        class="password-input" 
                        id="passwordInput" 
                        placeholder="Mot de passe administrateur"
                        maxlength="50"
                    >
                </div>
                <button class="login-btn" id="loginBtn">SE CONNECTER</button>
                <div class="error-message" id="errorMessage">
                    Mot de passe incorrect !
                </div>
            </div>
            
            <div class="loading" id="loading">
                <div class="spinner"></div>
            </div>
        </div>
    </div>

    <div class="admin-panel" id="adminPanel">
        <div class="admin-container">
            <!-- Navigation supprim√©e - uniquement swipe -->
        
        <!-- Main Content -->
        <div class="main-content">
                <!-- Page Rendez-vous -->
                <div class="page-content active" id="page-rendez-vous">
            <!-- Vue Mobile directe -->
            <div class="timeline-view" id="timelineViewContainer">
                <!-- Titre centr√© -->
                <div class="page-title-center">
                    <h1 class="main-title">Rendez-vous</h1>
                </div>
                
                <!-- Actions -->
                <div class="rdv-actions">
                    <button class="btn-nouveau-rdv" id="addRdvMobile">
                        <span class="btn-icon">+</span>
                        <span class="btn-text">Nouveau RDV</span>
                    </button>
                </div>
                
                <!-- Navigation par jours -->
                <div class="date-navigation">
                    <button class="nav-btn" id="prevDayBtn">‚Äπ</button>
                    <div class="date-today" id="dateToday">
                        <span class="date-label" id="dayLabel">Aujourd'hui</span>
                        <span class="date-value" id="currentDateDisplay"></span>
                    </div>
                    <button class="nav-btn" id="nextDayBtn">‚Ä∫</button>
                </div>

                <!-- Recherche -->
                <div class="search-field">
                    <div class="search-icon">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                            <circle cx="6.5" cy="6.5" r="4.5" stroke="#000" stroke-width="1.5" fill="none"/>
                            <line x1="11" y1="11" x2="14" y2="14" stroke="#000" stroke-width="1.5" stroke-linecap="round"/>
                        </svg>
                    </div>
                    <input type="text" class="search-input" id="searchInputMobile" placeholder="Rechercher un RDV..." oninput="searchRdv(this.value)">
                </div>
                
                <div class="empty-state-mobile" id="emptyStateMobile" style="display: none;">
                    <h3>Aucun rendez-vous enregistr√©</h3>
                    <p>Ajoutez votre premier RDV</p>
                </div>
                
                <!-- Liste des rendez-vous -->
                <div class="appointments-list" id="appointmentsListMobile">
                    <!-- RDV g√©n√©r√©s dynamiquement -->
                </div>
            </div>

            <!-- Vue Statistiques -->
            <div class="stats-view" id="statsViewContainer" style="display: none;">
                <div class="mobile-header">
                    <div class="date-display">üìä Statistiques</div>
                    <div class="stats-summary">
                        <div class="stat-item">
                            <span class="stat-number" id="totalRdv">0</span>
                            <span class="stat-label">RDV Total</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number" id="totalRevenue">0‚Ç¨</span>
                            <span class="stat-label">Chiffre d'affaires</span>
                        </div>
                    </div>
                </div>
            </div>


                    </div>
                </div>
                
                
                <!-- Page Services -->
                <div class="page-content" id="page-services">
                    <div class="page-header">
                        <h2 class="page-title">Services & Tarifs</h2>
                        <div class="page-actions">
                            <button class="add-btn">+ Nouveau Service</button>
                        </div>
                    </div>
                    <div class="coming-soon">
                        <h3>Gestion des services</h3>
                        <p>Cette section sera bient√¥t disponible</p>
                    </div>
                </div>
                
                
                <!-- Page Statistiques -->
                <div class="page-content" id="page-stats">
                    <!-- Titre centr√© -->
                    <div class="page-title-center">
                        <h1 class="main-title">Statistiques</h1>
                    </div>
                    
                    <!-- S√©lecteur de p√©riode -->
                    <div class="stats-period-selector">
                        <button class="period-btn active" data-period="today">Aujourd'hui</button>
                        <button class="period-btn" data-period="week">7 jours</button>
                        <button class="period-btn" data-period="month">1 mois</button>
                        <button class="period-btn" data-period="year">1 an</button>
                        <button class="period-btn" data-period="total">Total</button>
                    </div>
                    
                    <!-- Cartes de statistiques -->
                    <div class="stats-cards-container">
                        <div class="stats-card">
                            <div class="stats-value" id="statsRevenue">0‚Ç¨</div>
                            <div class="stats-label">Somme Totale</div>
                        </div>
                        
                        <div class="stats-card">
                            <div class="stats-value" id="statsTotal">0</div>
                            <div class="stats-label">Total RDV</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modale RDV -->
    <div class="modal-overlay" id="rdvModal" style="display: none;">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="modalTitle">Nouveau Rendez-vous</h3>
                <button class="modal-close" id="modalClose">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                    </svg>
                </button>
            </div>
            
            <form class="modal-form" id="rdvForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="rdvDate">Date</label>
                        <input type="date" id="rdvDate">
                    </div>
                    <div class="form-group">
                        <label for="rdvTime">Heure</label>
                        <input type="time" id="rdvTime">
                    </div>
                </div>
                
                <!-- Champ dur√©e supprim√© -->

                <div class="form-group">
                    <label for="rdvPrice">Prix (‚Ç¨)</label>
                    <div class="price-control">
                        <button type="button" class="price-btn" id="decreasePrice">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M19 13H5v-2h14v2z"/>
                            </svg>
                        </button>
                        <input type="number" id="rdvPrice" min="0" step="1" value="10">
                        <button type="button" class="price-btn" id="increasePrice">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                            </svg>
                        </button>
                    </div>
                    <button type="button" class="btn-save-price" id="savePriceBtn" style="margin-top: 10px;">Sauvegarder ce prix</button>
                </div>
                
                <div class="form-group">
                    <div class="price-favorites">
                        <div class="price-custom-favorites" id="customPriceFavorites"></div>
                    </div>
                </div>
                
                
                <div class="form-group">
                    <label for="rdvNotes">Notes</label>
                    <textarea id="rdvNotes" rows="3" placeholder="Notes particuli√®res..."></textarea>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn-cancel" id="cancelBtn">Annuler</button>
                    <button type="submit" class="btn-save" id="saveBtn">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                        </svg>
                        Enregistrer
                    </button>
                </div>
            </form>
        </div>
    </div>
    </div>

    <script type="module">
        // Import Firebase modules
        // Variables Firebase globales
        let initializeApp, getFirestore, collection, addDoc, getDocs, doc, updateDoc, deleteDoc, query, orderBy;
        let getAuth, signInAnonymously, signOut, onAuthStateChanged, getAnalytics;
        
        // Variables d'√©tat
        let firebaseLoaded = false;
        let isFileMode = location.protocol === 'file:';
        
        console.log(`üîç Protocole d√©tect√©: ${location.protocol}`);
        
        if (isFileMode) {
            console.log('üìÅ Mode LOCAL (file://) - Firebase compl√®tement d√©sactiv√©');
            console.log('üíæ Mode localStorage exclusif');
            
            // Mock functions pour √©viter les erreurs
            window.db = null;
            window.auth = null;
            window.analytics = null;
        }

        // Fonction helper pour v√©rifier si Firebase est pr√™t
        window.isFirebaseReady = function() {
            return !isFileMode && 
                   window.db && 
                   firebaseLoaded &&
                   collection && 
                   addDoc && 
                   getDocs && 
                   updateDoc && 
                   deleteDoc && 
                   query && 
                   orderBy;
        };

        // Fonction helper pour attendre que Firebase soit pr√™t
        window.waitForFirebase = function() {
            return new Promise((resolve) => {
                if (window.isFirebaseReady()) {
                    resolve(true);
                    return;
                }
                
                if (isFileMode) {
                    resolve(false);
                    return;
                }
                
                const checkInterval = setInterval(() => {
                    if (window.isFirebaseReady()) {
                        clearInterval(checkInterval);
                        resolve(true);
                    }
                }, 100);
                
                // Timeout apr√®s 5 secondes
                setTimeout(() => {
                    clearInterval(checkInterval);
                    resolve(false);
                }, 5000);
            });
        };

        // Global color toggle functions avec Firebase
        window.toggleColorSchemeFromButton = async function(button) {
            const body = document.body;
            const isGreenMode = body.classList.contains('green-mode');
            
            let newScheme;
            // Toggle le mode
            if (isGreenMode) {
                // Retour au mode orange
                body.classList.remove('green-mode');
                newScheme = 'orange';
            } else {
                // Passage au mode vert
                body.classList.add('green-mode');
                newScheme = 'green';
            }
            
            // Sauvegarder dans localStorage ET Firebase
            localStorage.setItem('color-scheme', newScheme);
            await saveColorSchemeToFirebase(newScheme);
            
            // Mettre √† jour tous les boutons video-btn
            updateAllVideoButtons();
        };

        // Fonction pour mettre √† jour l'apparence de tous les boutons vid√©o
        window.updateAllVideoButtons = function() {
            const isGreenMode = document.body.classList.contains('green-mode');
            const videoButtons = document.querySelectorAll('.video-btn');
            
            videoButtons.forEach(btn => {
                if (isGreenMode) {
                    btn.classList.add('green-active');
                } else {
                    btn.classList.remove('green-active');
                }
            });
        }

        // Initialisation Firebase CONDITIONNELLE
        if (!isFileMode) {
            // Import dynamique Firebase seulement en mode web
            (async function initFirebase() {
                try {
                    console.log('üåê Mode WEB - chargement Firebase...');
                    
                    // Import dynamique des modules
                    const firebaseApp = await import('https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js');
                    const firebaseFirestore = await import('https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js');
                    const firebaseAuth = await import('https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js');
                    const firebaseAnalytics = await import('https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js');
                    
                    // Assignation des fonctions
                    initializeApp = firebaseApp.initializeApp;
                    getFirestore = firebaseFirestore.getFirestore;
                    collection = firebaseFirestore.collection;
                    addDoc = firebaseFirestore.addDoc;
                    getDocs = firebaseFirestore.getDocs;
                    doc = firebaseFirestore.doc;
                    updateDoc = firebaseFirestore.updateDoc;
                    deleteDoc = firebaseFirestore.deleteDoc;
                    query = firebaseFirestore.query;
                    orderBy = firebaseFirestore.orderBy;
                    getAuth = firebaseAuth.getAuth;
                    getAnalytics = firebaseAnalytics.getAnalytics;

                    // Configuration Firebase
                    const firebaseConfig = {
                        apiKey: "AIzaSyD9od-leaUSWqvWcBORI88RbOgPVd0kkSs",
                        authDomain: "lvn-simple.firebaseapp.com",
                        projectId: "lvn-simple",
                        storageBucket: "lvn-simple.firebasestorage.app",
                        messagingSenderId: "10546147088",
                        appId: "1:10546147088:web:7054b9a1eb1a9571857f95",
                        measurementId: "G-HNCYTB5813"
                    };

                    // Initialisation Firebase
                    const app = initializeApp(firebaseConfig);
                    window.analytics = getAnalytics(app);
                    window.db = getFirestore(app);
                    window.auth = getAuth(app);
                    
                    firebaseLoaded = true;
                    console.log('üî• Firebase initialis√© avec succ√®s');
                    
                } catch (error) {
                    console.error('‚ùå Erreur initialisation Firebase:', error);
                    window.db = null;
                    window.auth = null;
                    window.analytics = null;
                }
            })();
        }

        // Syst√®me Firebase complet pour couleurs et √©tat
        async function saveColorSchemeToFirebase(colorScheme) {
            // Attendre que Firebase soit pr√™t
            const isReady = await window.waitForFirebase();
            if (!isReady) {
                console.log('üìÅ Mode local - sauvegarde couleur ignor√©e (d√©j√† en localStorage)');
                return;
            }

            try {
                const userDoc = {
                    colorScheme: colorScheme,
                    timestamp: new Date(),
                    sessionId: getSessionId()
                };
                
                await addDoc(collection(window.db, 'user-preferences'), userDoc);
                console.log('‚úÖ Couleur sauvegard√©e Firebase:', colorScheme);
            } catch (error) {
                console.warn('‚ö†Ô∏è Impossible de sauvegarder en Firebase:', error.message);
            }
        }

        async function loadColorSchemeFromFirebase() {
            // Attendre que Firebase soit pr√™t
            const isReady = await window.waitForFirebase();
            if (!isReady) {
                console.log('üìÅ Mode local d√©tect√© - chargement depuis localStorage uniquement');
                // Aller directement au fallback localStorage
                loadColorSchemeFromLocalStorage();
                return;
            }

            try {
                const q = query(
                    collection(window.db, 'user-preferences'),
                    orderBy('timestamp', 'desc')
                );
                const querySnapshot = await getDocs(q);
                
                if (!querySnapshot.empty) {
                    const latestDoc = querySnapshot.docs[0];
                    const colorScheme = latestDoc.data().colorScheme;
                    
                    // Appliquer le th√®me
                    if (colorScheme === 'green') {
                        document.body.classList.add('green-mode');
                    } else {
                        document.body.classList.remove('green-mode');
                    }
                    
                    localStorage.setItem('color-scheme', colorScheme);
                    updateAllVideoButtons();
                    console.log('‚úÖ Th√®me charg√© Firebase:', colorScheme);
                    return;
                }
            } catch (error) {
                console.warn('‚ö†Ô∏è Firebase inaccessible, basculement localStorage:', error.message);
            }
            
            // Fallback localStorage
            loadColorSchemeFromLocalStorage();
        }

        // Fonction pour charger le th√®me depuis localStorage
        function loadColorSchemeFromLocalStorage() {
            const savedScheme = localStorage.getItem('color-scheme');
            if (savedScheme === 'green') {
                document.body.classList.add('green-mode');
                updateAllVideoButtons();
                console.log('üíæ Th√®me charg√© localStorage: green');
            } else {
                console.log('üíæ Th√®me par d√©faut: blanc');
            }
        }

        // ID de session unique
        function getSessionId() {
            let sessionId = localStorage.getItem('session-id');
            if (!sessionId) {
                sessionId = Date.now() + '-' + Math.random().toString(36).substr(2, 9);
                localStorage.setItem('session-id', sessionId);
            }
            return sessionId;
        }

        // Sauvegarde Firebase pour RDV
        async function saveRdvToFirebase(rdv) {
            // Attendre que Firebase soit pr√™t
            const isReady = await window.waitForFirebase();
            if (!isReady) {
                console.log('üìÅ Mode local - RDV d√©j√† en localStorage');
                return;
            }

            try {
                await addDoc(collection(window.db, 'rendez-vous'), {
                    ...rdv,
                    timestamp: new Date(),
                    sessionId: getSessionId()
                });
                console.log('‚úÖ RDV sauvegard√© Firebase:', rdv.id);
            } catch (error) {
                console.error('‚ùå Erreur sauvegarde RDV:', error);
            }
        }

        async function updateRdvInFirebase(rdvId, data) {
            try {
                // Trouver le document dans Firebase
                const q = query(collection(db, 'rendez-vous'), orderBy('timestamp', 'desc'));
                const querySnapshot = await getDocs(q);
                
                querySnapshot.forEach(async (docSnap) => {
                    const docData = docSnap.data();
                    if (docData.id === rdvId) {
                        await updateDoc(doc(db, 'rendez-vous', docSnap.id), {
                            ...data,
                            updatedAt: new Date()
                        });
                        console.log('‚úÖ RDV mis √† jour Firebase:', rdvId);
                    }
                });
            } catch (error) {
                console.error('‚ùå Erreur mise √† jour RDV:', error);
            }
        }

        async function loadRdvFromFirebase() {
            // Attendre que Firebase soit pr√™t
            const isReady = await window.waitForFirebase();
            if (!isReady) {
                console.log('üìÅ Firebase indisponible - chargement depuis localStorage');
                return [];
            }

            try {
                const q = query(collection(window.db, 'rendez-vous'), orderBy('timestamp', 'desc'));
                const querySnapshot = await getDocs(q);
                
                const rdvMap = new Map();
                querySnapshot.forEach((docSnap) => {
                    const rdvData = docSnap.data();
                    if (rdvData.id) {
                        // Garder seulement la version la plus r√©cente de chaque RDV
                        if (!rdvMap.has(rdvData.id)) {
                            rdvMap.set(rdvData.id, rdvData);
                        }
                    }
                });
                
                const loadedRdvs = Array.from(rdvMap.values());
                console.log('‚úÖ RDV charg√©s depuis Firebase:', loadedRdvs.length);
                return loadedRdvs;
            } catch (error) {
                console.error('‚ùå Erreur chargement RDV:', error);
                return [];
            }
        }

        // Fonction pour les statistiques (simple fallback)
        async function saveStatsToFirebase(statsData) {
            try {
                const today = formatDate(new Date());
                await addDoc(collection(db, 'daily-stats'), {
                    date: today,
                    revenue: statsData.totalRevenue,
                    appointments: statsData.totalAppointments,
                    clients: statsData.clientsCount,
                    averagePrice: statsData.averagePrice,
                    serviceStats: statsData.serviceStats,
                    timestamp: new Date(),
                    sessionId: getSessionId()
                });
                console.log('‚úÖ Stats sauvegard√©es Firebase:', today);
            } catch (error) {
                console.log('üìä Stats en localStorage uniquement (Firebase local non disponible)');
            }
        }
        
        console.log('üî• Syst√®me Firebase complet activ√©');

        // DOM elements
        const adminBtn = document.getElementById('adminBtn');
        const passwordForm = document.getElementById('passwordForm');
        const passwordInput = document.getElementById('passwordInput');
        const loginBtn = document.getElementById('loginBtn');
        const errorMessage = document.getElementById('errorMessage');
        const loading = document.getElementById('loading');
        const loginCard = document.getElementById('loginCard');
        const loginContainer = document.getElementById('loginContainer');
        const adminPanel = document.getElementById('adminPanel');
        const logoutBtn = document.getElementById('logoutBtn');

        // Admin password
        const ADMIN_PASSWORD = 'lvnbarber';

        // Check if already logged in
        // Mode local avec persistance de connexion
        let isLoggedIn = localStorage.getItem('adminLoggedIn') === 'true';
        
        // V√©rification de connexion au d√©marrage (mode local)
        if (isLoggedIn) {
            showAdminPanel();
        } else {
            // Affichage du formulaire de connexion par d√©faut
            console.log('üë§ Affichage du formulaire de connexion');
        }

        // Charger les pr√©f√©rences couleur depuis Firebase au d√©marrage
        loadColorSchemeFromFirebase();



        // Show password form with animation
        adminBtn.addEventListener('click', () => {
            adminBtn.style.transform = 'translateY(0) scale(0.95)';
            adminBtn.style.opacity = '0.7';
            adminBtn.style.transition = 'all 0.1s ease';
            
            setTimeout(() => {
                adminBtn.style.transform = 'translateY(-20px) scale(0.9)';
                adminBtn.style.opacity = '0';
            }, 80);
            
            setTimeout(() => {
                adminBtn.style.display = 'none';
                
                setTimeout(() => {
                    passwordForm.classList.add('show');
                    // Focus sur le champ mot de passe apr√®s l'animation
                    setTimeout(() => {
                        passwordInput.focus();
                    }, 600);
                }, 50);
            }, 200);
        });

        // Handle login
        loginBtn.addEventListener('click', handleLogin);
        passwordInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                handleLogin();
            }
        });

        function handleLogin() {
            const password = passwordInput.value.trim();
            
            if (!password) {
                showError('Veuillez saisir un mot de passe');
                return;
            }

            // Animation du bouton de connexion
            loginBtn.style.transform = 'translateY(0) scale(0.95)';
            loginBtn.style.opacity = '0.8';
            loginBtn.disabled = true;
            
            setTimeout(() => {
                loginBtn.style.transform = 'translateY(-5px) scale(0.9)';
                loginBtn.style.opacity = '0';
            }, 200);

            // Show loading apr√®s l'animation du bouton
            setTimeout(() => {
                loginBtn.style.display = 'none';
                loading.style.display = 'block';
                loading.style.opacity = '0';
                loading.style.transform = 'translateY(20px)';
                
                setTimeout(() => {
                    loading.style.opacity = '1';
                    loading.style.transform = 'translateY(0)';
                }, 100);
            }, 400);
            
            // Simulate authentication delay
            setTimeout(() => {
                if (password === ADMIN_PASSWORD) {
                    // Animation de succ√®s avant transition
                    loading.style.transform = 'translateY(-10px) scale(1.1)';
                    setTimeout(() => {
                        // Mode local uniquement
                        isLoggedIn = true;
                        localStorage.setItem('adminLoggedIn', 'true');
                        showAdminPanel();
                        console.log('‚úÖ Connexion r√©ussie en mode local');
                    }, 300);
                } else {
                    // Animation d'√©chec
                    loading.style.opacity = '0';
                    loading.style.transform = 'translateY(-20px)';
                    
                    setTimeout(() => {
                        loading.style.display = 'none';
                        loginBtn.style.display = 'block';
                        loginBtn.style.opacity = '0';
                        loginBtn.style.transform = 'translateY(20px)';
                        loginBtn.disabled = false;
                        
                        setTimeout(() => {
                            loginBtn.style.opacity = '1';
                            loginBtn.style.transform = 'translateY(0)';
                        }, 100);
                        
                        showError('Mot de passe incorrect !');
                        passwordInput.value = '';
                        passwordInput.focus();
                    }, 300);
                }
            }, 1800);
        }

        function showError(message) {
            errorMessage.textContent = message;
            errorMessage.classList.add('show');
            
            setTimeout(() => {
                errorMessage.classList.remove('show');
            }, 3000);
        }

        function showAdminPanel() {
            // Animation de sortie √©l√©gante
            loginContainer.style.transition = 'all 0.5s cubic-bezier(0.4, 0, 0.2, 1)';
            loginContainer.style.opacity = '0';
            loginContainer.style.transform = 'translateY(-30px) scale(0.95)';
            
            setTimeout(() => {
                loginContainer.style.display = 'none';
                adminPanel.style.display = 'block';
                
                // 1. Animation du panel entier d'abord
                setTimeout(() => {
                    adminPanel.classList.add('show');
                }, 50);
                
                // 2. Header supprim√©
                
                // 3. Puis animation du syst√®me RDV
                // Animation rdv-system supprim√©e
                
                // 4. Initialiser le syst√®me
                setTimeout(async () => {
                    await initAdminSystem();
                }, 400);
            }, 300);
        }

        // Fonction de d√©connexion en mode local
        function logout() {
            isLoggedIn = false;
            localStorage.removeItem('adminLoggedIn');
            showLoginForm();
            showNotification('D√©connect√© avec succ√®s', 'success');
            console.log('üëã D√©connexion r√©ussie');
        }
        
        // Fonction pour afficher le formulaire de connexion
        function showLoginForm() {
            adminPanel.style.display = 'none';
            loginContainer.style.display = 'flex';
            loginContainer.style.opacity = '0';
            loginContainer.style.transform = 'translateY(-30px) scale(0.95)';
            setTimeout(() => {
                loginContainer.style.opacity = '1';
                loginContainer.style.transform = 'translateY(0) scale(1)';
            }, 50);
        }

        console.log('üî• Firebase initialized successfully');
        
        // Fonction helper pour v√©rifier si Firebase est utilisable
        window.isFirebaseUsable = function() {
            if (location.protocol === 'file:') {
                return false;
            }
            return window.db !== null && window.db !== undefined;
        };
        console.log('üîê Admin system ready');


        // Admin System Functions
        let currentDate = new Date();
        let currentView = 'list';
        let currentPage = 'rendez-vous';
        let rdvData = [];
        let selectedDate = new Date(); // Date s√©lectionn√©e pour la navigation

        async function initAdminSystem() {
            initNavigation();
            await initRdvSystem();
            initializeStats();
        }

        function initNavigation() {
            // Navigation par swipe uniquement
        }

        function switchPage(pageId) {
            // Update content uniquement
            document.querySelectorAll('.page-content').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(`page-${pageId}`).classList.add('active');
            
            currentPage = pageId;
        }

        async function initRdvSystem() {
            // currentDate d√©j√† d√©clar√©e globalement
            currentDate = new Date();
            selectedDate = new Date(); // Initialiser la date s√©lectionn√©e √† aujourd'hui
            
            // Mettre √† jour la date d'aujourd'hui
            updateCurrentDateDisplay();
            
            // Event listeners pour la navigation par jours
            document.getElementById('prevDayBtn').addEventListener('click', goToPreviousDay);
            document.getElementById('nextDayBtn').addEventListener('click', goToNextDay);
            document.getElementById('addRdvMobile').addEventListener('click', openAddRdvModal);
            
            // Recherche mobile
            const searchInputMobile = document.getElementById('searchInputMobile');
            searchInputMobile.addEventListener('input', () => {
                setTimeout(updateView, 300);
            });
            
            // Syst√®me de swipe
            initSwipeSystem();
            
            // Bouton addRdvBtn supprim√© - utilisation du bouton mobile uniquement
            // Pas de changement de date manuel
            
            // Load initial data
            await loadRdvData();
            
            // Modal event listeners
            await setupModalEvents();
        }
        
        async function setupModalEvents() {
            // Fermer modale
            document.getElementById('modalClose').addEventListener('click', hideModal);
            document.getElementById('cancelBtn').addEventListener('click', hideModal);
            
            // Fermer modale en cliquant √† l'ext√©rieur
            document.getElementById('rdvModal').addEventListener('click', (e) => {
                if (e.target.id === 'rdvModal') {
                    hideModal();
                }
            });
            
            // Soumission du formulaire
            document.getElementById('rdvForm').addEventListener('submit', handleRdvSubmit);
            
            // √âchap pour fermer
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && isModalOpen) {
                    hideModal();
                }
            });
            
            // Configuration du syst√®me de prix
            await setupPriceSystem();

            // Configuration du syst√®me de dur√©e
            // setupDurationSystem() supprim√©
        }

        async function setupPriceSystem() {
            const priceInput = document.getElementById('rdvPrice');
            const decreaseBtn = document.getElementById('decreasePrice');
            const increaseBtn = document.getElementById('increasePrice');
            const quickBtns = document.querySelectorAll('.price-quick-btn');
            const savePriceBtn = document.getElementById('savePriceBtn');
            const customFavoritesContainer = document.getElementById('customPriceFavorites');

            // Charger les prix favoris personnalis√©s
            await loadCustomPrices();

            // Gestionnaires pour les boutons +/-
            decreaseBtn.addEventListener('click', (e) => {
                e.preventDefault();
                let currentPrice = parseInt(priceInput.value) || 10;
                if (currentPrice > 0) {
                    priceInput.value = Math.max(0, currentPrice - 1);
                    updateActiveQuickButton();
                }
            });

            increaseBtn.addEventListener('click', (e) => {
                e.preventDefault();
                let currentPrice = parseInt(priceInput.value) || 10;
                priceInput.value = currentPrice + 1;
                updateActiveQuickButton();
            });

            // Gestionnaires pour les boutons prix rapides
            quickBtns.forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.preventDefault();
                    const price = parseInt(btn.dataset.price);
                    priceInput.value = price;
                    updateActiveQuickButton();
                });
            });

            // Gestionnaire pour sauvegarder un prix personnalis√©
            savePriceBtn.addEventListener('click', (e) => {
                e.preventDefault();
                const currentPrice = parseInt(priceInput.value);
                if (currentPrice > 0) {
                    savePriceFavorite(currentPrice);
                }
            });

            // Mettre √† jour l'√©tat actif lors de la saisie manuelle
            priceInput.addEventListener('input', updateActiveQuickButton);

            // Event listener pour la recherche
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.addEventListener('input', function() {
                    updateView();
                });
            }

            function updateActiveQuickButton() {
                const currentPrice = parseInt(priceInput.value);
                
                // Retirer la classe active de tous les boutons
                quickBtns.forEach(btn => btn.classList.remove('active'));
                document.querySelectorAll('.custom-price-btn').forEach(btn => btn.classList.remove('active'));
                
                // Ajouter la classe active au bouton correspondant
                quickBtns.forEach(btn => {
                    if (parseInt(btn.dataset.price) === currentPrice) {
                        btn.classList.add('active');
                    }
                });
                
                document.querySelectorAll('.custom-price-btn').forEach(btn => {
                    if (parseInt(btn.dataset.price) === currentPrice) {
                        btn.classList.add('active');
                    }
                });
            }
        }

        async function loadCustomPrices() {
            let customPrices = [];
            try {
                if (isLoggedIn && db) {
                    const snapshot = await getDocs(collection(db, 'customPriceFavorites'));
                    customPrices = snapshot.docs.map(doc => ({ id: doc.id, price: doc.data().price }));
                    customPrices.sort((a, b) => b.price - a.price);
                } else {
                    // Fallback vers localStorage
                    customPrices = JSON.parse(localStorage.getItem('customPriceFavorites') || '[]').map(price => ({ price }));
                }
            } catch (error) {
                console.error('Erreur lors du chargement des prix favoris:', error);
                customPrices = JSON.parse(localStorage.getItem('customPriceFavorites') || '[]').map(price => ({ price }));
            }
            
            const container = document.getElementById('customPriceFavorites');
            
            container.innerHTML = '';
            
            customPrices.forEach(priceObj => {
                const btn = document.createElement('button');
                btn.type = 'button';
                btn.className = 'custom-price-btn';
                btn.dataset.price = priceObj.price;
                btn.innerHTML = `
                    ${priceObj.price}‚Ç¨
                    <button class="remove-price" data-price="${priceObj.price}" data-id="${priceObj.id || ''}">√ó</button>
                `;
                
                // Gestionnaire pour s√©lectionner le prix
                btn.addEventListener('click', (e) => {
                    if (!e.target.classList.contains('remove-price')) {
                        e.preventDefault();
                        document.getElementById('rdvPrice').value = priceObj.price;
                        updateActiveQuickButton();
                    }
                });
                
                // Gestionnaire pour supprimer le prix
                const removeBtn = btn.querySelector('.remove-price');
                removeBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    const docId = e.target.dataset.id;
                    removePriceFavorite(priceObj.price, docId);
                });
                
                container.appendChild(btn);
            });
        }

        async function savePriceFavorite(price) {
            try {
                if (isLoggedIn && db) {
                    // V√©rifier si le prix existe d√©j√† dans Firebase
                    const snapshot = await getDocs(collection(db, 'customPriceFavorites'));
                    const existingPrices = snapshot.docs.map(doc => doc.data().price);
                    
                    if (existingPrices.includes(parseFloat(price))) {
                        showToast('Ce prix est d√©j√† dans vos favoris', 'info');
                        return;
                    }
                    
                    // Limiter √† 10 prix favoris maximum
                    if (existingPrices.length >= 10) {
                        showToast('Maximum 10 prix favoris autoris√©s', 'error');
                        return;
                    }
                    
                    // Ajouter le nouveau prix √† Firebase
                    await addDoc(collection(db, 'customPriceFavorites'), {
                        price: parseFloat(price),
                        createdAt: new Date()
                    });
                    
                    showToast('Prix ajout√© aux favoris', 'success');
                } else {
                    // Fallback vers localStorage
                    let customPrices = JSON.parse(localStorage.getItem('customPriceFavorites') || '[]');
                    
                    if (customPrices.includes(price)) {
                        showToast('Ce prix est d√©j√† dans vos favoris', 'info');
                        return;
                    }
                    
                    customPrices.push(price);
                    customPrices.sort((a, b) => a - b);
                    
                    if (customPrices.length > 10) {
                        customPrices = customPrices.slice(0, 10);
                    }
                    
                    localStorage.setItem('customPriceFavorites', JSON.stringify(customPrices));
                    showToast('Prix ajout√© aux favoris!', 'success');
                }
                
                // Recharger les prix favoris
                await loadCustomPrices();
                
            } catch (error) {
                console.error('Erreur lors de l\'ajout du prix favori:', error);
                showToast('Erreur lors de l\'ajout', 'error');
            }
        }

        async function removePriceFavorite(price, docId = null) {
            try {
                if (isLoggedIn && db) {
                    if (docId) {
                        // Supprimer par ID de document
                        await deleteDoc(doc(db, 'customPriceFavorites', docId));
                    } else {
                        // Trouver et supprimer par prix
                        const snapshot = await getDocs(collection(db, 'customPriceFavorites'));
                        const docToDelete = snapshot.docs.find(doc => doc.data().price === parseFloat(price));
                        if (docToDelete) {
                            await deleteDoc(doc(db, 'customPriceFavorites', docToDelete.id));
                        }
                    }
                    showToast('Prix supprim√© des favoris', 'info');
                } else {
                    // Fallback vers localStorage
                    let customPrices = JSON.parse(localStorage.getItem('customPriceFavorites') || '[]');
                    customPrices = customPrices.filter(p => p !== price);
                    localStorage.setItem('customPriceFavorites', JSON.stringify(customPrices));
                    showToast('Prix supprim√© des favoris', 'info');
                }
                
                // Recharger les prix favoris
                await loadCustomPrices();
                
            } catch (error) {
                console.error('Erreur lors de la suppression du prix favori:', error);
                showToast('Erreur lors de la suppression', 'error');
            }
        }

        // Syst√®me de dur√©e (favoris, UI)
        // Syst√®me de dur√©e supprim√©

        // Fonctions de dur√©e supprim√©es

        function updateActiveQuickButton() {
            const currentPrice = parseInt(document.getElementById('rdvPrice').value);
            
            // Retirer la classe active de tous les boutons
            document.querySelectorAll('.price-quick-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.custom-price-btn').forEach(btn => btn.classList.remove('active'));
            
            // Ajouter la classe active au bouton correspondant
            document.querySelectorAll('.price-quick-btn').forEach(btn => {
                if (parseInt(btn.dataset.price) === currentPrice) {
                    btn.classList.add('active');
                }
            });
            
            document.querySelectorAll('.custom-price-btn').forEach(btn => {
                if (parseInt(btn.dataset.price) === currentPrice) {
                    btn.classList.add('active');
                }
            });
        }

        function formatDate(date) {
            // Format local YYYY-MM-DD (√©vite le d√©calage UTC de toISOString)
            const y = date.getFullYear();
            const m = (date.getMonth() + 1).toString().padStart(2, '0');
            const d = date.getDate().toString().padStart(2, '0');
            return `${y}-${m}-${d}`;
        }

        // Fonctions de navigation par dates supprim√©es

        function clearSearchAndUpdate() {
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.value = '';
            }
            // Vider explicitement la liste avant de recharger
            clearAppointmentsList();
            updateView();
        }
        
        function clearAppointmentsList() {
            const listContainer = document.getElementById('rdvList');
            if (listContainer) {
                listContainer.innerHTML = '<div class="loading-state">Chargement des rendez-vous...</div>';
            }
        }

        function updateTimelineView() {
            const searchInput = document.getElementById('searchInputMobile');
            const searchTerm = searchInput ? searchInput.value.toLowerCase().trim() : '';
            
            console.log('üì± Mise √† jour interface mobile, total RDV:', rdvData.length);
            
            // Convertir la date s√©lectionn√©e au format YYYY-MM-DD pour la comparaison
            const selectedDateStr = selectedDate.toISOString().split('T')[0];
            
            let rdvsToShow;
            
            if (searchTerm) {
                rdvsToShow = rdvData.filter(rdv => {
                    // Filtrer par date s√©lectionn√©e ET par terme de recherche
                    const matchesDate = rdv.date === selectedDateStr;
                    const matchesSearch = (rdv.notes && rdv.notes.toLowerCase().includes(searchTerm)) ||
                                         (rdv.price && rdv.price.toString().includes(searchTerm)) ||
                                         (rdv.startTime && rdv.startTime.includes(searchTerm)) ||
                                         (rdv.paymentStatus && rdv.paymentStatus.toLowerCase().includes(searchTerm));
                    return matchesDate && matchesSearch;
                }).sort((a, b) => {
                    const timeA = a.startTime || "00:00";
                    const timeB = b.startTime || "00:00";
                    return timeA.localeCompare(timeB);
                });
            } else {
                // Afficher seulement les rendez-vous du jour s√©lectionn√©
                rdvsToShow = rdvData.filter(rdv => {
                    return rdv.date === selectedDateStr;
                }).sort((a, b) => {
                    const timeA = a.startTime || "00:00";
                    const timeB = b.startTime || "00:00";
                    return timeA.localeCompare(timeB);
                });
                console.log('üì± RDV pour', selectedDateStr, ':', rdvsToShow.length);
            }

            // Mettre √† jour l'affichage de la date
            updateMobileDateDisplay();
            
            // G√©n√©rer les cards mobiles
            generateMobileAppointments(rdvsToShow, searchTerm);
        }

        function updateMobileDateDisplay() {
            const mobileDateDisplay = document.getElementById('mobileDateDisplay');
            if (mobileDateDisplay) {
                const today = new Date();
                const isToday = currentDate.toDateString() === today.toDateString();
                
                if (isToday) {
                    mobileDateDisplay.textContent = 'Aujourd\'hui';
                } else {
                    const options = { weekday: 'long', day: 'numeric', month: 'long' };
                    mobileDateDisplay.textContent = currentDate.toLocaleDateString('fr-FR', options);
                }
            }
        }

        function generateMobileAppointments(rdvsToShow, searchTerm) {
            const appointmentsList = document.getElementById('appointmentsListMobile');
            const emptyState = document.getElementById('emptyStateMobile');
            
            if (rdvsToShow.length === 0) {
                appointmentsList.innerHTML = '';
                emptyState.style.display = 'block';
                
                const emptyMessage = searchTerm 
                    ? `Aucun RDV trouv√© pour "${searchTerm}"`
                    : `Aucun rendez-vous enregistr√©`;
                    
                emptyState.innerHTML = `
                    <h3>${emptyMessage}</h3>
                    <p>Ajoutez votre premier RDV</p>
                `;
                return;
            }

            emptyState.style.display = 'none';
            
            let appointmentsHTML = '';
            
            rdvsToShow.forEach((rdv, index) => {
                const isPaid = rdv.paymentStatus === 'paid';
                const statusClass = isPaid ? 'paid' : 'unpaid';
                const statusText = isPaid ? 'Pay√©' : 'Non pay√©';
                
                const displayDate = ` - ${formatFrenchDate(rdv.date)}`;
                
                appointmentsHTML += `
                    <div class="appointment-card ${statusClass}" data-rdv-id="${rdv.id}" data-click-action="edit">
                        <div class="card-header">
                            <div class="time-badge">
                                ${rdv.startTime || '?'}${displayDate}
                            </div>
                            <div class="price-badge">${rdv.price || 0}‚Ç¨</div>
                        </div>
                        
                        <div class="card-content" style="position: relative;">
                            <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                                ${rdv.notes ? `<div class="appointment-notes-mobile">${rdv.notes}</div>` : '<div></div>'}
                                <div style="display: flex; flex-direction: column; align-items: center; gap: 8px;">
                                    <button class="remove-rdv-btn" onclick="event.stopPropagation(); deleteRdv('${rdv.id}')" title="Supprimer ce rendez-vous">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="#EF4444">
                                            <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                                        </svg>
                                    </button>
                                    <button class="payment-check-btn ${isPaid ? 'checked' : ''}" onclick="event.stopPropagation(); togglePaymentStatus('${rdv.id}')" title="${isPaid ? 'Marquer comme non pay√©' : 'Marquer comme pay√©'}">
                                        <div class="check-circle">
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <path d="M9 12l2 2 4-4"/>
                                            </svg>
                                        </div>
                                    </button>
                                </div>
                            </div>
                        </div>

                    </div>
                `;
            });
            
            appointmentsList.innerHTML = appointmentsHTML;
            console.log('üì± Interface mobile g√©n√©r√©e avec', rdvsToShow.length, 'rendez-vous');
            
            // Ajouter les event listeners s√©curis√©s pour les clics
            addSafeClickListeners();
        }

        function addSafeClickListeners() {
            // Ajouter des listeners s√©curis√©s pour les rendez-vous
            document.querySelectorAll('.appointment-card[data-click-action="edit"]').forEach(card => {
                card.addEventListener('click', (e) => {
                    // Emp√™cher le clic si on vient de swiper
                    if (isSwiping) {
                        e.preventDefault();
                        e.stopPropagation();
                        return;
                    }
                    
                    const rdvId = card.getAttribute('data-rdv-id');
                    editRdv(rdvId);
                });
            });
        }
        
        function formatFrenchDate(dateStr) {
            if (!dateStr) return '';
            const date = new Date(dateStr);
            const options = { day: 'numeric', month: 'short' };
            return date.toLocaleDateString('fr-FR', options);
        }
        
        function updateCurrentDateDisplay() {
            const currentDateDisplay = document.getElementById('currentDateDisplay');
            const dayLabel = document.getElementById('dayLabel');
            
            if (currentDateDisplay && dayLabel) {
                const today = new Date();
                const isToday = selectedDate.toDateString() === today.toDateString();
                const isYesterday = selectedDate.toDateString() === new Date(today.getTime() - 24 * 60 * 60 * 1000).toDateString();
                const isTomorrow = selectedDate.toDateString() === new Date(today.getTime() + 24 * 60 * 60 * 1000).toDateString();
                
                // Mettre √† jour le label du jour
                if (isToday) {
                    dayLabel.textContent = 'Aujourd\'hui';
                } else if (isYesterday) {
                    dayLabel.textContent = 'Hier';
                } else if (isTomorrow) {
                    dayLabel.textContent = 'Demain';
                } else {
                    const options = { weekday: 'long' };
                    dayLabel.textContent = selectedDate.toLocaleDateString('fr-FR', options);
                }
                
                // Mettre √† jour la date
                const options = { 
                    day: 'numeric', 
                    month: 'long', 
                    year: 'numeric' 
                };
                const dateStr = selectedDate.toLocaleDateString('fr-FR', options);
                currentDateDisplay.textContent = dateStr;
            }
        }
        
        function goToPreviousDay() {
            selectedDate.setDate(selectedDate.getDate() - 1);
            updateCurrentDateDisplay();
            updateView();
        }
        
        function goToNextDay() {
            selectedDate.setDate(selectedDate.getDate() + 1);
            updateCurrentDateDisplay();
            updateView();
        }

        function updateView() {
            updateTimelineView();
            updateStatsView();
            
            // Ajouter les event listeners pour les boutons de suppression
            addDeleteEventListeners();
        }

        // Variables globales pour le swipe am√©lior√©
        let touchStartX = 0;
        let touchStartY = 0;
        let isScrolling = false;
        let swipeThreshold = 40; // Seuil encore plus r√©duit pour plus de r√©activit√©
        let isTransitioning = false; // √âviter les swipes multiples
        let isSwiping = false; // Tracker si on est en train de swiper

        function initSwipeSystem() {
            const swipeArea = document.body; // Toute la page
            
            // Touch events (mobile) - sur toute la page
            swipeArea.addEventListener('touchstart', handleTouchStart, { passive: true });
            swipeArea.addEventListener('touchmove', handleTouchMove, { passive: false });
            swipeArea.addEventListener('touchend', handleTouchEnd, { passive: true });
            
            // Mouse events (PC - swipe avec clic gauche) - sur toute la page
            let isDragging = false;
            let mouseStartX = 0;
            let hasMovedEnough = false;
            
            swipeArea.addEventListener('mousedown', (e) => {
                // Seulement clic gauche
                if (e.button !== 0) return;
                
                // Ne pas d√©clencher sur les boutons et inputs
                if (e.target.tagName === 'BUTTON' || e.target.tagName === 'INPUT' || e.target.tagName === 'SELECT' || e.target.tagName === 'TEXTAREA') {
                    return;
                }
                
                isDragging = true;
                mouseStartX = e.clientX;
                hasMovedEnough = false;
                isSwiping = false; // Reset du swipe
                swipeArea.style.cursor = 'grab'; // Main ouverte
                swipeArea.style.userSelect = 'none'; // Emp√™cher la s√©lection de texte
            });
            
            swipeArea.addEventListener('mousemove', (e) => {
                if (!isDragging) return;
                
                const deltaX = e.clientX - mouseStartX;
                
                // Indiquer qu'on a boug√© assez pour consid√©rer un swipe (seuil r√©duit)
                if (Math.abs(deltaX) > 15) {
                    hasMovedEnough = true;
                    isSwiping = true; // On est en train de swiper
                    e.preventDefault(); // Emp√™cher la s√©lection de texte
                    
                    // Feedback visuel plus r√©actif
                    document.body.style.transform = `translateX(${deltaX * 0.08}px)`;
                    document.body.style.transition = 'none';
                }
                
                // Garder seulement la main ferm√©e pendant le drag
                if (hasMovedEnough) {
                    swipeArea.style.cursor = 'grabbing'; // Main ferm√©e
                }
            });
            
            swipeArea.addEventListener('mouseup', (e) => {
                if (!isDragging) return;
                
                const deltaX = e.clientX - mouseStartX;
                
                // D√©clencher le swipe si on a boug√© assez (seuil r√©duit)
                if (hasMovedEnough && Math.abs(deltaX) > swipeThreshold) {
                    if (deltaX > 0) {
                        swipeRight();
                    } else {
                        swipeLeft();
                    }
                }
                
                // Reset avec nettoyage du feedback visuel
                isDragging = false;
                hasMovedEnough = false;
                swipeArea.style.cursor = 'default';
                swipeArea.style.userSelect = 'auto';
                
                // Remettre le body √† sa position normale rapidement
                document.body.style.transform = '';
                document.body.style.transition = 'transform 0.1s ease';
                
                // Emp√™cher les clics accidentels apr√®s swipe
                setTimeout(() => {
                    isSwiping = false;
                }, 100);
            });
            
            // G√©rer le cas o√π la souris sort de la fen√™tre
            swipeArea.addEventListener('mouseleave', () => {
                if (isDragging) {
                    isDragging = false;
                    hasMovedEnough = false;
                    swipeArea.style.cursor = 'default';
                    swipeArea.style.userSelect = 'auto';
                    
                    // Nettoyer le feedback visuel rapidement
                    document.body.style.transform = '';
                    document.body.style.transition = 'transform 0.1s ease';
                }
            });
            
            // Emp√™cher le drag sur les images et liens
            swipeArea.addEventListener('dragstart', (e) => {
                e.preventDefault();
            });
            
        }

        function handleTouchStart(e) {
            touchStartX = e.touches[0].clientX;
            touchStartY = e.touches[0].clientY;
            isScrolling = false;
            isSwiping = false;
        }

        function handleTouchMove(e) {
            if (!touchStartX || !touchStartY) return;
            
            const touchCurrentX = e.touches[0].clientX;
            const touchCurrentY = e.touches[0].clientY;
            
            const deltaX = touchCurrentX - touchStartX;
            const deltaY = touchCurrentY - touchStartY;
            
            // Si le mouvement horizontal est plus important que vertical
            if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > 20) {
                isScrolling = false;
                isSwiping = true; // On commence √† swiper
                e.preventDefault(); // Emp√™cher le scroll quand on swipe horizontalement
            } else if (Math.abs(deltaY) > Math.abs(deltaX)) {
                isScrolling = true; // C'est un scroll vertical
                isSwiping = false;
            }
        }

        function handleTouchEnd(e) {
            if (!touchStartX) return;
            
            const touchEndX = e.changedTouches[0].clientX;
            const deltaX = touchEndX - touchStartX;
            
            // Seuil plus bas pour les swipes tactiles
            // Am√©lioration: seuil r√©duit et v√©rification de v√©locit√©
            if (!isScrolling && Math.abs(deltaX) > swipeThreshold) {
                if (deltaX > 0) {
                    swipeRight();
                } else {
                    swipeLeft();
                }
            }
            
            touchStartX = 0;
            touchStartY = 0;
            isScrolling = false;
            
            // Remettre isSwiping √† false apr√®s un d√©lai pour √©viter les clics accidentels
            setTimeout(() => {
                isSwiping = false;
            }, 100);
        }

        function swipeLeft() {
            // Swipe vers la gauche : Rendez-vous ‚Üí Statistiques
            if (isTransitioning) return; // √âviter les swipes multiples
            
            if (currentPage === 'rendez-vous') {
                performSwipeTransition('stats', 'slide');
            }
        }

        function swipeRight() {
            // Swipe vers la droite : Statistiques ‚Üí Rendez-vous
            if (isTransitioning) return; // √âviter les swipes multiples
            
            if (currentPage === 'stats') {
                performSwipeTransition('rendez-vous', 'slide');
            }
        }

        function switchToPage(page) {
            if (page === currentPage) return;
            performSwipeTransition(page, 'slide');
        }
        
        function performSwipeTransition(targetPage, direction) {
            if (isTransitioning || targetPage === currentPage) return;
            
            isTransitioning = true;
            const currentPageEl = document.getElementById(`page-${currentPage}`);
            const targetPageEl = document.getElementById(`page-${targetPage}`);
            
            if (!currentPageEl || !targetPageEl) {
                isTransitioning = false;
                return;
            }
            
            // Animation rapide et fluide
            const transition = 'opacity 0.15s ease-out, transform 0.15s ease-out';
            currentPageEl.style.transition = transition;
            targetPageEl.style.transition = transition;
            
            // Positionner la page cible
            targetPageEl.classList.add('active');
            
            // Animation simple et identique pour tous les cas
            targetPageEl.style.opacity = '0';
            targetPageEl.style.transform = 'scale(0.95)';
            
            requestAnimationFrame(() => {
                currentPageEl.style.opacity = '0';
                currentPageEl.style.transform = 'scale(0.95)';
                
                targetPageEl.style.opacity = '1';
                targetPageEl.style.transform = 'scale(1)';
            });
            
            // Nettoyer apr√®s la transition
            setTimeout(() => {
                currentPageEl.classList.remove('active');
                currentPageEl.style.transform = '';
                currentPageEl.style.opacity = '';
                currentPageEl.style.transition = '';
                
                targetPageEl.style.transform = '';
                targetPageEl.style.opacity = '';
                targetPageEl.style.transition = '';
                
                currentPage = targetPage;
                updatePageTitle();
                isTransitioning = false;
                
                console.log('üîÑ Transition vers:', targetPage, direction);
            }, 170); // Animation ultra-rapide
        }

        function updatePageTitle() {
            const mobileDateDisplay = document.getElementById('mobileDateDisplay');
            if (currentPage === 'stats') {
                if (mobileDateDisplay) mobileDateDisplay.textContent = 'üìä Statistiques';
            } else {
                // Rendez-vous - afficher la date
                updateMobileDateDisplay();
            }
        }

        function updateStatsView() {
            if (currentPage !== 'stats') return;
            
            const totalRdv = rdvData.length;
            const totalRevenue = rdvData.reduce((sum, rdv) => sum + (parseFloat(rdv.price) || 0), 0);
            
            document.getElementById('totalRdv').textContent = totalRdv;
            document.getElementById('totalRevenue').textContent = totalRevenue + '‚Ç¨';
        }

        function addDeleteEventListeners() {
            // Utiliser la d√©l√©gation d'√©v√©nements sur le conteneur parent
            document.removeEventListener('click', handleDeleteClick);
            document.addEventListener('click', handleDeleteClick);
        }

        function handleDeleteClick(e) {
            // G√©rer les clics de suppression
            if (e.target.closest('.action-delete[data-rdv-id], .delete-btn[data-rdv-id], .btn-delete[data-rdv-id]')) {
                e.preventDefault();
                const btn = e.target.closest('.action-delete[data-rdv-id], .delete-btn[data-rdv-id], .btn-delete[data-rdv-id]');
                const rdvId = btn.getAttribute('data-rdv-id');
                if (rdvId) {
                    confirmDeleteRdv(rdvId);
                }
            }
            
            // G√©rer les clics d'√©dition
            if (e.target.closest('.action-edit[data-rdv-id], .edit-btn[data-rdv-id], .btn-edit[data-rdv-id]')) {
                e.preventDefault();
                const btn = e.target.closest('.action-edit[data-rdv-id], .edit-btn[data-rdv-id], .btn-edit[data-rdv-id]');
                const rdvId = btn.getAttribute('data-rdv-id');
                if (rdvId) {
                    editRdv(rdvId);
                }
            }
        }

        function updateListView() {
            const searchInput = document.getElementById('searchInput');
            const searchTerm = searchInput ? searchInput.value.toLowerCase().trim() : '';
            
            console.log('üìã Mise √† jour liste, total RDV:', rdvData.length);
            
            let rdvsToShow;
            
            if (searchTerm) {
                // Recherche dans TOUS les rendez-vous
                rdvsToShow = rdvData.filter(rdv => {
                    return (rdv.notes && rdv.notes.toLowerCase().includes(searchTerm)) ||
                           (rdv.price && rdv.price.toString().includes(searchTerm)) ||
                           (rdv.startTime && rdv.startTime.includes(searchTerm)) ||
                           (rdv.date && rdv.date.includes(searchTerm)) ||
                           (rdv.paymentStatus && rdv.paymentStatus.toLowerCase().includes(searchTerm));
                }).sort((a, b) => {
                    // Trier par date puis par heure pour la recherche
                    const dateA = a.date || "0000-00-00";
                    const dateB = b.date || "0000-00-00";
                    const dateCompare = dateA.localeCompare(dateB);
                    if (dateCompare !== 0) return dateCompare;
                    
                    const timeA = a.startTime || "00:00";
                    const timeB = b.startTime || "00:00";
                    return timeA.localeCompare(timeB);
                });
            } else {
                // Affichage normal : seulement les rendez-vous du jour s√©lectionn√©
                // Afficher tous les rendez-vous tri√©s par date puis heure
                rdvsToShow = rdvData
                    .sort((a, b) => {
                        // Tri par date d'abord (plus r√©cent en premier)
                        const dateCompare = (b.date || '').localeCompare(a.date || '');
                        if (dateCompare !== 0) return dateCompare;
                        
                        // Puis par heure
                        const timeA = a.startTime || "00:00";
                        const timeB = b.startTime || "00:00";
                        return timeA.localeCompare(timeB);
                    });
                console.log('üìã Total RDV affich√©s:', rdvsToShow.length);
            }
            
            const listContainer = document.getElementById('appointmentsListMobile');
            const emptyState = document.getElementById('emptyStateMobile');
            
            if (!listContainer) {
                console.error('‚ùå Element appointmentsListMobile not found');
                return;
            }
            
            if (rdvsToShow.length === 0) {
                const emptyMessage = searchTerm 
                    ? `Aucun rendez-vous trouv√© pour "${searchTerm}"`
                    : `Aucun rendez-vous enregistr√©`;
                    
                listContainer.innerHTML = '';
                
                if (emptyState) {
                    emptyState.innerHTML = `
                        <h3>${emptyMessage}</h3>
                        <p>Ajoutez votre premier RDV</p>
                    `;
                    emptyState.style.display = 'block';
                }
                return;
            } else {
                if (emptyState) {
                    emptyState.style.display = 'none';
                }
                
                if (searchTerm) {
                    // Pour la recherche, grouper par date
                    const rdvsByDate = {};
                    rdvsToShow.forEach(rdv => {
                        const date = rdv.date;
                        if (!rdvsByDate[date]) {
                            rdvsByDate[date] = [];
                        }
                        rdvsByDate[date].push(rdv);
                    });
                    
                    let html = '';
                    Object.keys(rdvsByDate).sort().forEach(date => {
                        const dateObj = new Date(date + 'T00:00:00');
                        const dateFormatted = dateObj.toLocaleDateString('fr-FR', {
                            weekday: 'long',
                            day: 'numeric',
                            month: 'long'
                        });
                        
                        html += `<div class="date-separator">${dateFormatted}</div>`;
                        html += rdvsByDate[date].map(rdv => createRdvCard(rdv)).join('');
                    });
                    
                    listContainer.innerHTML = html;
                } else {
                    // Affichage normal sans s√©parateur de date
                    listContainer.innerHTML = rdvsToShow.map(rdv => createRdvCard(rdv)).join('');
                }
            }
        }

        function createRdvCard(rdv) {
            const isPaid = rdv.paymentStatus === 'paid';
            const time24 = rdv.startTime;
            const [hour, minute] = time24.split(':');
            const timeDisplay = `${hour}:${minute}`;
            const endDisplay = rdv.endTime || computeEndTime(rdv.startTime, rdv.durationMinutes || 30);
            
            return `
                <div class="rdv-card-modern ${isPaid ? 'rdv-paid' : 'rdv-unpaid'}" data-rdv-id="${rdv.id}">
                    <div class="rdv-header">
                        <div class="rdv-time-display">
                            <span class="time-hour">${hour}</span>
                            <span class="time-separator">:</span>
                            <span class="time-minute">${minute}</span>
                            <span class="time-range">&nbsp;‚Äì ${endDisplay}</span>
                        </div>
                        <div class="rdv-price-display">
                            <span class="price-amount">${rdv.price || 0}</span>
                            <span class="price-currency">‚Ç¨</span>
                        </div>
                    </div>
                    
                    <div class="rdv-content">
                        ${rdv.notes ? `
                            <div class="rdv-notes-modern">
                                <span class="notes-text">${rdv.notes}</span>
                            </div>
                        ` : ''}
                        
                        
                    </div>
                    
                    <div class="rdv-actions-modern">
                        <button class="btn-modern btn-delete" data-rdv-id="${rdv.id}" title="Supprimer">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                            </svg>
                        </button>
                    </div>
                </div>
            `;
        }


        function updateAgendaView_DELETED() {
            const calendarGrid = document.getElementById('calendarGrid');
            const calendarTitle = document.getElementById('calendarTitle');
            
            // Calculer la semaine actuelle (Lundi √† Dimanche)
            const startOfWeek = new Date(currentDate);
            const dayOfWeek = startOfWeek.getDay();
            const diff = startOfWeek.getDate() - dayOfWeek + (dayOfWeek === 0 ? -6 : 1); // Commencer par lundi
            startOfWeek.setDate(diff);
            
            const endOfWeek = new Date(startOfWeek);
            endOfWeek.setDate(startOfWeek.getDate() + 6);
            
            // Mettre √† jour le titre
            const options = { day: 'numeric', month: 'long' };
            calendarTitle.textContent = `Semaine du ${startOfWeek.toLocaleDateString('fr-FR', options)} au ${endOfWeek.toLocaleDateString('fr-FR', options)}`;
            
            // Cr√©er l'agenda style Google avec grille semaine
            let gridHTML = `
                <div class="google-agenda">
                    <!-- En-t√™te avec les jours -->
                    <div class="week-header">
                        <div class="time-gutter">Heure</div>
            `;
            
            const dayNames = ['Lun', 'Mar', 'Mer', 'Jeu', 'Ven', 'Sam', 'Dim'];
            for (let i = 0; i < 7; i++) {
                const day = new Date(startOfWeek);
                day.setDate(startOfWeek.getDate() + i);
                const isToday = day.toDateString() === new Date().toDateString();
                
                gridHTML += `
                    <div class="day-header ${isToday ? 'today' : ''}">
                        <div class="day-name">${dayNames[i]}</div>
                        <div class="day-number">${day.getDate()}</div>
                    </div>
                `;
            }
            
            gridHTML += `</div>`;
            
            // Grille minute: 24h x 60min, 1px par minute, avec colonnes par jour
            gridHTML += `<div class="week-grid minute-grid">`;

            // Colonne des heures (gutter)
            gridHTML += `<div class="time-gutter-col">`;
            for (let hour = 0; hour <= 23; hour++) {
                const top = hour * 60 * parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--minute-px') || '1');
                const hourStr = hour.toString().padStart(2, '0') + ':00';
                gridHTML += `<div class="gutter-hour" style="top:${top}px">${hourStr}</div>`;
            }
            gridHTML += `</div>`;

            // Colonnes des jours
            for (let dayIndex = 0; dayIndex < 7; dayIndex++) {
                const currentDay = new Date(startOfWeek);
                currentDay.setDate(startOfWeek.getDate() + dayIndex);
                const dayStr = formatDate(currentDay);

                // Contenu de la colonne jour (√©v√©nements absolutis√©s)
                let dayColHTML = '';

                const dayRdvs = rdvData.filter(rdv => rdv.date === dayStr && rdv.startTime);
                dayRdvs.forEach(rdv => {
                    const isPaid = rdv.paymentStatus === 'paid';
                    const [hh, mm] = rdv.startTime.split(':').map(Number);
                    const startMin = hh * 60 + (mm || 0);
                    const px = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--minute-px') || '1');
                    const duration = rdv.durationMinutes || (rdv.endTime ? (() => { const [eh, em] = rdv.endTime.split(':').map(Number); return (eh*60+(em||0)) - startMin; })() : 30);
                    const height = Math.max(10 * px, duration * px); // min height visuelle, scale vertical
                    const endDisplay = rdv.endTime || computeEndTime(rdv.startTime, duration);

                    dayColHTML += `
                        <div class="google-event ${isPaid ? 'paid' : 'unpaid'}" style="top:${startMin * px}px;height:${height}px" onclick="editRdv('${rdv.id}')">
                            <div class="event-time">${rdv.startTime} ‚Äì ${endDisplay}</div>
                            <div class="event-content">
                                <div class="event-price">${rdv.price || 0}‚Ç¨</div>
                                ${rdv.notes ? `<div class="event-notes">${rdv.notes}</div>` : ''}
                            </div>
                            <div class="event-actions-right" onclick="event.stopPropagation()">
                                <button class="btn-delete-event" onclick="confirmDeleteRdv('${rdv.id}')">√ó</button>
                            </div>
                        </div>
                    `;
                });

                gridHTML += `<div class="day-column" data-date="${dayStr}">${dayColHTML}</div>`;
            }

            gridHTML += `</div></div>`;
            
            calendarGrid.innerHTML = gridHTML;

            // Attacher les interactions (s√©lection/drag pour cr√©er)
            attachAgendaInteractions();
            console.log('üìÖ Agenda semaine Google mise √† jour (minute grid)');
        }

        function minutesToHHMM(totalMinutes) {
            const m = Math.max(0, Math.min(1439, Math.round(totalMinutes)));
            const hh = Math.floor(m / 60);
            const mm = m % 60;
            return `${hh.toString().padStart(2,'0')}:${mm.toString().padStart(2,'0')}`;
        }

        function attachAgendaInteractions() {
            const weekGrid = document.querySelector('#calendarGrid .week-grid');
            if (!weekGrid) return;

            let isSelecting = false;
            let startY = 0;
            let selectionEl = null;
            let activeDayCol = null;

            function getY(e, el) {
                const rect = el.getBoundingClientRect();
                const scroll = weekGrid.scrollTop;
                const px = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--minute-px') || '1');
                const minutes = ((e.clientY - rect.top) + scroll) / px;
                return Math.max(0, Math.min(1440, minutes));
            }

            function clearSelection() {
                if (selectionEl && selectionEl.parentNode) selectionEl.remove();
                selectionEl = null;
                isSelecting = false;
                activeDayCol = null;
            }

            weekGrid.querySelectorAll('.day-column').forEach(col => {
                let hoverLabel = null;

                col.addEventListener('mousedown', (e) => {
                    if (e.button !== 0) return; // left only
                    if (e.target.closest('.google-event')) return; // ignore on events
                    isSelecting = true;
                    activeDayCol = col;
                    // Snap d√©part sur pas de 5 minutes
                    startY = Math.round(getY(e, col) / 5) * 5;
                    selectionEl = document.createElement('div');
                    selectionEl.className = 'selection-block';
                    selectionEl.style.top = `${startY}px`;
                    selectionEl.style.height = `0px`;
                    col.appendChild(selectionEl);
                });

                col.addEventListener('mousemove', (e) => {
                    const y = getY(e, col);
                    const yRounded = Math.round(y / 5) * 5; // pas de 5 min

                    // Afficher l'heure sous la souris avant s√©lection
                    if (!isSelecting) {
                        if (!hoverLabel) {
                            hoverLabel = document.createElement('div');
                            hoverLabel.className = 'hover-time-indicator';
                            col.appendChild(hoverLabel);
                        }
                        const px = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--minute-px') || '1');
                        hoverLabel.style.top = `${yRounded * px}px`;
                        hoverLabel.textContent = minutesToHHMM(yRounded);
                        return;
                    }

                    // Pendant la s√©lection
                    if (activeDayCol !== col || !selectionEl) return;
                    const top = Math.min(startY, yRounded);
                    const minutes = Math.max(5, Math.abs(yRounded - startY));
                    const px = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--minute-px') || '1');
                    selectionEl.style.top = `${top * px}px`;
                    selectionEl.style.height = `${minutes * px}px`;
                    const startMin = top;
                    const startHHMM = minutesToHHMM(startMin);
                    const endHHMM = minutesToHHMM(startMin + minutes);
                    let label = selectionEl.querySelector('.selection-label');
                    if (!label) {
                        label = document.createElement('div');
                        label.className = 'selection-label';
                        selectionEl.appendChild(label);
                    }
                    label.textContent = `${minutes} min ¬∑ ${startHHMM} ‚Äì ${endHHMM}`;
                });

                function finalize(e) {
                    if (!isSelecting || activeDayCol !== col) return;
                    const yEnd = Math.round(getY(e, col) / 5) * 5;
                    const top = Math.min(startY, yEnd);
                    let height = Math.abs(yEnd - startY);
                    const dateStr = col.getAttribute('data-date');
                    // Click sans drag: 30 min
                    if (height < 3) height = 30;

                    // Arrondir √† 5 min
                    const startRounded = top; // d√©j√† arrondi
                    const durRounded = Math.max(5, Math.round(height / 5) * 5);
                    const startTime = minutesToHHMM(startRounded);

                    // Ouvrir modale pr√©-remplie
                    openAddRdvModal(dateStr, startTime);
                    // Dur√©e fixe - plus de saisie

                    clearSelection();
                }

                col.addEventListener('mouseup', finalize);
                col.addEventListener('mouseleave', (e) => {
                    if (isSelecting) finalize(e);
                    // Nettoyer l'indicateur hover quand on sort
                    if (hoverLabel && hoverLabel.parentNode) hoverLabel.remove();
                    hoverLabel = null;
                });

                // Laisser le scroll de page par d√©faut (molette)
                // Pas d'interception ici pour ne pas bloquer le scroll de la page
            });
        }

        async function loadRdvData() {
            try {
                console.log('üîÑ Loading RDV from Firebase...');
                
                // Essayer de charger depuis Firebase d'abord
                const firebaseRdvs = await loadRdvFromFirebase();
                
                if (firebaseRdvs.length > 0) {
                    rdvData = firebaseRdvs;
                    // Sauvegarder aussi dans localStorage pour backup
                    localStorage.setItem('rdvData', JSON.stringify(rdvData));
                    console.log('‚úÖ RDV loaded from Firebase:', rdvData.length, 'appointments');
                } else {
                    // Fallback sur localStorage
                    console.log('üîÑ Fallback: Loading from localStorage...');
                    const savedRdvData = localStorage.getItem('rdvData');
                    if (savedRdvData) {
                        rdvData = JSON.parse(savedRdvData);
                        console.log('‚úÖ RDV loaded from localStorage:', rdvData.length, 'appointments');
                    } else {
                        rdvData = [];
                        console.log('‚ÑπÔ∏è No RDV found, starting with empty array');
                    }
                }
                
                sortRdvData();
                updateView();
                
            } catch (error) {
                console.error('‚ùå Error loading RDV:', error);
                // Fallback ultime sur localStorage
                const savedRdvData = localStorage.getItem('rdvData');
                rdvData = savedRdvData ? JSON.parse(savedRdvData) : [];
                sortRdvData();
                updateView();
            }
        }

        async function createDemoData() {
            const demoRdvs = [
                {
                    date: formatDate(new Date()),
                    startTime: '09:00',
                    price: 25,
                    paymentStatus: 'unpaid',
                    notes: 'RDV d√©mo - non pay√©',
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                },
                {
                    date: formatDate(new Date()),
                    startTime: '14:30',
                    price: 15,
                    paymentStatus: 'paid',
                    notes: 'RDV d√©mo - pay√©',
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                },
                {
                    date: formatDate(new Date()),
                    startTime: '16:00',
                    price: 30,
                    paymentStatus: 'unpaid',
                    notes: 'RDV d√©mo - en attente',
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                }
            ];

            for (const rdv of demoRdvs) {
                try {
                    const docRef = await addDoc(collection(db, 'appointments'), rdv);
                    rdvData.push({ id: docRef.id, ...rdv });
                } catch (error) {
                    console.error('‚ùå Error creating demo data:', error);
                }
            }
            
            updateView();
            console.log('‚úÖ Demo data created');
        }

        // Variables globales pour la modale
        let currentEditId = null;
        let isModalOpen = false;

        // Utilitaires
        function getPaymentLabel(payment) {
            const labels = {
                'unpaid': 'Non pay√©',
                'paid': 'Pay√©'
            };
            return labels[payment] || payment;
        }
        
        // Fonctions de statistiques
        let currentStatsPeriod = 'today';
        
        function initializeStats() {
            // Event listeners pour les anciens boutons de p√©riode
            document.querySelectorAll('.period-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.period-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentStatsPeriod = btn.getAttribute('data-period');
                    updateStats();
                });
            });
            
            // Event listeners pour les nouveaux boutons noirs
            document.querySelectorAll('.period-btn-black').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.period-btn-black').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentStatsPeriod = btn.getAttribute('data-period');
                    updateStats();
                });
            });
            
            updateStats();
        }
        
        // Nouveau syst√®me statistiques noir et blanc - RDV pay√©s uniquement
        function updateStats() {
            console.log('üìä Mise √† jour statistiques noir et blanc...');
            const paidStats = calculatePaidStats(currentStatsPeriod);
            console.log('üìä Stats RDV pay√©s:', paidStats);
            displayPaidStats(paidStats);
            updatePaidChart();
            updateRecentPaidList();
        }
        
        function calculatePaidStats(period) {
            const now = new Date();
            const today = formatDate(now);
            
            let filteredRdvs;
            let periodName;
            
            switch(period) {
                case 'today':
                    filteredRdvs = rdvData.filter(rdv => rdv.date === today);
                    periodName = 'Aujourd\'hui';
                    break;
                    
                case 'week':
                    const startDate = new Date(now);
                    startDate.setDate(now.getDate() - 6);
                    filteredRdvs = rdvData.filter(rdv => {
                        const rdvDate = new Date(rdv.date + 'T00:00:00');
                        return rdvDate >= startDate && rdvDate <= now;
                    });
                    periodName = '7 derniers jours';
                    break;
                    
                case 'month':
                    const startMonth = new Date(now);
                    startMonth.setDate(now.getDate() - 29);
                    filteredRdvs = rdvData.filter(rdv => {
                        const rdvDate = new Date(rdv.date + 'T00:00:00');
                        return rdvDate >= startMonth && rdvDate <= now;
                    });
                    periodName = '30 derniers jours';
                    break;
                    
                case 'year':
                    const startYear = new Date(now);
                    startYear.setDate(now.getDate() - 364);
                    filteredRdvs = rdvData.filter(rdv => {
                        const rdvDate = new Date(rdv.date + 'T00:00:00');
                        return rdvDate >= startYear && rdvDate <= now;
                    });
                    periodName = '365 derniers jours';
                    break;
                    
                default:
                    filteredRdvs = rdvData.filter(rdv => rdv.date === today);
                    periodName = 'Aujourd\'hui';
            }
            
            // Filtrer uniquement les RDV pay√©s
            const paidRdvs = filteredRdvs.filter(rdv => rdv.paymentStatus === 'paid');
            
            // Calculs
            const totalAmount = paidRdvs.reduce((sum, rdv) => sum + (parseFloat(rdv.price) || 0), 0);
            const averageAmount = paidRdvs.length > 0 ? totalAmount / paidRdvs.length : 0;
            
            return {
                periodName,
                count: paidRdvs.length,
                totalAmount: Math.round(totalAmount * 100) / 100,
                averageAmount: Math.round(averageAmount * 100) / 100,
                paidRdvs: paidRdvs.sort((a, b) => new Date(b.date + 'T' + (b.startTime || '00:00')) - new Date(a.date + 'T' + (a.startTime || '00:00')))
            };
        }
        
        function displayPaidStats(stats) {
            console.log('üìä Affichage stats pay√©s:', stats);
            
            // Mise √† jour des r√©sum√©s
            const paidCount = document.getElementById('paidCount');
            const paidTotal = document.getElementById('paidTotal');
            const paidAverage = document.getElementById('paidAverage');
            const chartPeriodInfo = document.getElementById('chartPeriodInfo');
            
            if (paidCount) paidCount.textContent = stats.count;
            if (paidTotal) paidTotal.textContent = `${stats.totalAmount}‚Ç¨`;
            if (paidAverage) paidAverage.textContent = `${stats.averageAmount}‚Ç¨`;
            if (chartPeriodInfo) chartPeriodInfo.textContent = stats.periodName;
        }

        function updatePaidChart() {
            const canvas = document.getElementById('paidAppointmentsChart');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            const now = new Date();
            
            // Donn√©es pour le graphique selon la p√©riode
            let chartData = [];
            let labels = [];
            let days = 7;
            
            switch(currentStatsPeriod) {
                case 'today':
                    days = 1;
                    break;
                case 'week':
                    days = 7;
                    break;
                case 'month':
                    days = 30;
                    break;
                case 'year':
                    days = 365;
                    break;
            }
            
            // Calculer les donn√©es jour par jour
            for (let i = days - 1; i >= 0; i--) {
                const date = new Date(now);
                date.setDate(now.getDate() - i);
                const dateStr = formatDate(date);
                
                // RDV pay√©s de ce jour
                const dayPaidRdvs = rdvData.filter(rdv => rdv.date === dateStr && rdv.paymentStatus === 'paid');
                const dayCount = dayPaidRdvs.length;
                const dayAmount = dayPaidRdvs.reduce((sum, rdv) => sum + (parseFloat(rdv.price) || 0), 0);
                
                chartData.push({ count: dayCount, amount: Math.round(dayAmount * 100) / 100 });
                
                // Label selon la p√©riode
                if (days === 1) {
                    labels.push('Aujourd\'hui');
                } else if (days <= 7) {
                    const dayNames = ['Dim', 'Lun', 'Mar', 'Mer', 'Jeu', 'Ven', 'Sam'];
                    labels.push(`${dayNames[date.getDay()]} ${date.getDate()}`);
                } else if (days <= 30) {
                    labels.push(`${date.getDate()}/${date.getMonth() + 1}`);
                } else {
                    labels.push(`${date.getMonth() + 1}/${date.getFullYear().toString().slice(-2)}`);
                }
            }
            
            // Dessiner le graphique noir et blanc
            drawBlackWhiteChart(ctx, canvas.width, canvas.height, chartData, labels);
        }

        function drawBlackWhiteChart(ctx, width, height, data, labels) {
            ctx.clearRect(0, 0, width, height);
            
            const padding = 60;
            const chartWidth = width - 2 * padding;
            const chartHeight = height - 2 * padding;
            
            const maxCount = Math.max(...data.map(d => d.count), 1);
            const maxAmount = Math.max(...data.map(d => d.amount), 10);
            
            // Style noir et blanc
            ctx.font = '12px Inter, sans-serif';
            ctx.fillStyle = '#000000';
            ctx.strokeStyle = '#000000';
            ctx.lineWidth = 2;
            
            // Axe Y gauche (nombre)
            ctx.textAlign = 'right';
            ctx.fillText('Nombre RDV', padding - 10, padding - 10);
            
            // Axe Y droit (montant)
            ctx.textAlign = 'left';
            ctx.fillText('Montant (‚Ç¨)', width - padding + 10, padding - 10);
            
            // Grille
            ctx.strokeStyle = '#e5e5e5';
            ctx.lineWidth = 1;
            for (let i = 0; i <= 5; i++) {
                const y = padding + (i * chartHeight) / 5;
                ctx.beginPath();
                ctx.moveTo(padding, y);
                ctx.lineTo(padding + chartWidth, y);
                ctx.stroke();
            }
            
            // Barres (nombre de RDV)
            ctx.fillStyle = '#000000';
            data.forEach((point, index) => {
                const x = padding + (index * chartWidth) / Math.max(data.length - 1, 1);
                const barHeight = (point.count / maxCount) * chartHeight;
                const barWidth = Math.min(15, chartWidth / data.length * 0.6);
                
                ctx.fillRect(x - barWidth/2, padding + chartHeight - barHeight, barWidth, barHeight);
            });
            
            // Ligne (montant)
            ctx.strokeStyle = '#666666';
            ctx.lineWidth = 3;
            ctx.beginPath();
            data.forEach((point, index) => {
                const x = padding + (index * chartWidth) / Math.max(data.length - 1, 1);
                const y = padding + chartHeight - (point.amount / maxAmount) * chartHeight;
                
                if (index === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            });
            ctx.stroke();
            
            // Points sur la ligne
            ctx.fillStyle = '#666666';
            data.forEach((point, index) => {
                const x = padding + (index * chartWidth) / Math.max(data.length - 1, 1);
                const y = padding + chartHeight - (point.amount / maxAmount) * chartHeight;
                
                ctx.beginPath();
                ctx.arc(x, y, 4, 0, 2 * Math.PI);
                ctx.fill();
            });
            
            // Labels X
            ctx.fillStyle = '#000000';
            ctx.textAlign = 'center';
            labels.forEach((label, index) => {
                const x = padding + (index * chartWidth) / Math.max(data.length - 1, 1);
                ctx.fillText(label, x, height - 20);
            });
            
            // Valeurs au-dessus des barres
            ctx.textAlign = 'center';
            data.forEach((point, index) => {
                const x = padding + (index * chartWidth) / Math.max(data.length - 1, 1);
                const barHeight = (point.count / maxCount) * chartHeight;
                const y = padding + chartHeight - barHeight - 5;
                
                if (point.count > 0) {
                    ctx.fillText(point.count.toString(), x, y);
                }
                
                // Montants sur la ligne
                const amountY = padding + chartHeight - (point.amount / maxAmount) * chartHeight - 10;
                if (point.amount > 0) {
                    ctx.fillText(`${point.amount}‚Ç¨`, x, amountY);
                }
            });
        }

        function updateRecentPaidList() {
            const container = document.getElementById('recentPaidList');
            if (!container) return;
            
            // R√©cup√©rer les 10 derniers RDV pay√©s
            const recentPaid = rdvData
                .filter(rdv => rdv.paymentStatus === 'paid')
                .sort((a, b) => new Date(b.date + 'T' + (b.startTime || '00:00')) - new Date(a.date + 'T' + (a.startTime || '00:00')))
                .slice(0, 10);
            
            container.innerHTML = '';
            
            if (recentPaid.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666666; padding: 20px;">Aucun rendez-vous pay√© trouv√©</p>';
                return;
            }
            
            recentPaid.forEach(rdv => {
                const item = document.createElement('div');
                item.className = 'recent-paid-item';
                
                const date = new Date(rdv.date + 'T00:00:00');
                const dateStr = date.toLocaleDateString('fr-FR', { 
                    weekday: 'short', 
                    day: 'numeric', 
                    month: 'short' 
                });
                
                item.innerHTML = `
                    <div class="recent-paid-info">
                        <div class="recent-paid-client">${rdv.clientName}</div>
                        <div class="recent-paid-date">${dateStr} √† ${rdv.startTime || 'N/A'}</div>
                    </div>
                    <div class="recent-paid-amount">${parseFloat(rdv.price || 0).toFixed(2)}‚Ç¨</div>
                `;
                
                container.appendChild(item);
            });
        }

        function sortRdvData() {
            rdvData.sort((a, b) => {
                // Tri par date d'abord
                const dateA = new Date(a.date);
                const dateB = new Date(b.date);
                
                if (dateA.getTime() !== dateB.getTime()) {
                    return dateA.getTime() - dateB.getTime(); // ASC
                }
                
                // Si m√™me date, tri par heure
                const timeA = a.startTime || '00:00';
                const timeB = b.startTime || '00:00';
                
                // Convertir "HH:MM" en minutes pour comparaison
                const [hoursA, minutesA] = timeA.split(':').map(Number);
                const [hoursB, minutesB] = timeB.split(':').map(Number);
                
                const totalMinutesA = hoursA * 60 + minutesA;
                const totalMinutesB = hoursB * 60 + minutesB;
                
                return totalMinutesA - totalMinutesB; // ASC
            });
        }

        // Fonctions de la modale
        function openAddRdvModal(date = null, time = null) {
            resetModalForm();
            if (date) {
                document.getElementById('rdvDate').value = date;
            }
            if (time) {
                document.getElementById('rdvTime').value = time;
            }
            showModal();
        }

        function showModal() {
            isModalOpen = true;
            const modal = document.getElementById('rdvModal');
            modal.style.display = 'flex';
            setTimeout(() => modal.classList.add('show'), 10);
        }

        function hideModal() {
            isModalOpen = false;
            const modal = document.getElementById('rdvModal');
            modal.classList.remove('show');
            setTimeout(() => {
                modal.style.display = 'none';
                // R√©initialiser le formulaire et le mode d'√©dition
                resetModalForm();
            }, 300);
        }
        
        function resetModalForm() {
            // R√©initialiser l'ID d'√©dition
            currentEditId = null;
            
            // R√©initialiser le titre
            document.getElementById('modalTitle').textContent = 'Nouveau Rendez-vous';
            
            // R√©initialiser les champs du formulaire
            document.getElementById('rdvForm').reset();
            const now = new Date();
            document.getElementById('rdvDate').value = formatDate(now);
            document.getElementById('rdvTime').value = formatTime(now);
            // Dur√©e fixe supprim√©e
            document.getElementById('rdvPrice').value = '';
            document.getElementById('rdvNotes').value = '';
            
        }

        function formatTime(date) {
            return date.toTimeString().slice(0, 5); // Format HH:MM
        }

        function computeEndTime(startTime, durationMinutes) {
            if (!startTime) return '';
            const [hours, minutes] = startTime.split(':').map(Number);
            const total = (hours * 60 + (minutes || 0)) + (parseInt(durationMinutes) || 0);
            const hh = Math.floor((total % (24 * 60)) / 60);
            const mm = total % 60;
            return `${hh.toString().padStart(2, '0')}:${mm.toString().padStart(2, '0')}`;
        }

        async function editRdv(id) {
            const rdv = rdvData.find(r => r.id === id);
            if (!rdv) {
                showNotification('Rendez-vous introuvable', 'error');
                return;
            }

            currentEditId = id;
            document.getElementById('modalTitle').textContent = 'Modifier Rendez-vous';
            
            // Pr√©-remplir le formulaire avec les donn√©es existantes
            document.getElementById('rdvDate').value = rdv.date;
            document.getElementById('rdvTime').value = rdv.startTime;
            // Dur√©e supprim√©e
            document.getElementById('rdvPrice').value = rdv.price || '';
            document.getElementById('rdvNotes').value = rdv.notes || '';
            
            // Mettre √† jour l'√©tat actif des boutons de prix
            setTimeout(() => {
                updateActiveQuickButton();
            }, 100);
            
            showModal();
        }

        async function duplicateRdv(id) {
            const rdv = rdvData.find(r => r.id === id);
            if (!rdv) return;

            currentEditId = null;
            document.getElementById('modalTitle').textContent = 'Dupliquer Rendez-vous';
            
            // Pr√©-remplir avec les donn√©es existantes mais nouvelle date
            document.getElementById('rdvDate').value = formatDate(currentDate);
            document.getElementById('rdvTime').value = rdv.startTime;
            // Dur√©e supprim√©e
            document.getElementById('rdvPrice').value = rdv.price || '';
            document.getElementById('rdvNotes').value = '';
            
            showModal();
        }

        async function toggleStatus(id) {
            const rdv = rdvData.find(r => r.id === id);
            if (!rdv) return;

            const statusFlow = ['prevu', 'arrive', 'encours', 'termine'];
            const currentIndex = statusFlow.indexOf(rdv.status);
            const nextStatus = currentIndex < statusFlow.length - 1 ? statusFlow[currentIndex + 1] : statusFlow[0];

            try {
                if (id.startsWith('demo')) {
                    // Mode d√©mo
                    rdv.status = nextStatus;
                    sortRdvData();
                    updateView();
                    showNotification('Statut chang√© (mode d√©mo)', 'success');
                } else {
                    const rdvRef = doc(db, 'appointments', id);
                    await updateDoc(rdvRef, { 
                        status: nextStatus,
                        updatedAt: new Date().toISOString()
                    });
                    rdv.status = nextStatus;
                    sortRdvData();
                    updateView();
                    showNotification('Statut chang√©', 'success');
                }
            } catch (error) {
                console.error('‚ùå Error updating status:', error);
                showNotification('Erreur lors du changement de statut', 'error');
            }
        }


        // Rendre les fonctions accessibles globalement

        window.updateStats = updateStats;

        // ===== SYST√àME DE STATISTIQUES =====
        
        // Fonction pour calculer les statistiques selon la p√©riode
        async function calculateStats(period = currentStatsPeriod) {
            const now = new Date();
            let startDate, endDate = now;
            
            switch(period) {
                case 'today':
                    startDate = new Date(now.getFullYear(), now.getMonth(), now.getDate());
                    break;
                case 'week':
                    startDate = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
                    break;
                case 'month':
                    startDate = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);
                    break;
                case 'year':
                    startDate = new Date(now.getTime() - 365 * 24 * 60 * 60 * 1000);
                    break;
                case 'total':
                default:
                    startDate = null; // Pas de limite
                    break;
            }
            
            let filteredRdvs = [];
            
            try {
                // Essayer de r√©cup√©rer depuis Firestore d'abord
                if (window.db && !isFileMode) {
                    console.log('üî• Calcul statistiques depuis Firestore...');
                    const q = startDate ? 
                        query(collection(window.db, 'rendez-vous'), 
                              where('createdAt', '>=', startDate),
                              where('createdAt', '<=', endDate)) :
                        query(collection(window.db, 'rendez-vous'));
                    
                    const querySnapshot = await getDocs(q);
                    querySnapshot.forEach((doc) => {
                        filteredRdvs.push(doc.data());
                    });
                } else {
                    // Fallback sur les donn√©es locales
                    console.log('üíæ Calcul statistiques depuis localStorage...');
                    filteredRdvs = rdvData.filter(rdv => {
                        if (!startDate) return true;
                        const rdvDate = new Date(rdv.date || rdv.createdAt);
                        return rdvDate >= startDate && rdvDate <= endDate;
                    });
                }
                
                // Calculer les m√©triques
                const totalRdvs = filteredRdvs.length;
                const paidRdvs = filteredRdvs.filter(rdv => rdv.paymentStatus === 'paid').length;
                const totalRevenue = filteredRdvs.reduce((sum, rdv) => {
                    const price = parseFloat(rdv.price) || 0;
                    return sum + price;
                }, 0);
                
                return {
                    totalRdvs,
                    paidRdvs,
                    totalRevenue: Math.round(totalRevenue * 100) / 100
                };
                
            } catch (error) {
                console.error('‚ùå Erreur calcul statistiques:', error);
                // Fallback complet sur localStorage
                filteredRdvs = rdvData.filter(rdv => {
                    if (!startDate) return true;
                    const rdvDate = new Date(rdv.date || rdv.createdAt);
                    return rdvDate >= startDate && rdvDate <= endDate;
                });
                
                const totalRdvs = filteredRdvs.length;
                const paidRdvs = filteredRdvs.filter(rdv => rdv.paymentStatus === 'paid').length;
                const totalRevenue = filteredRdvs.reduce((sum, rdv) => {
                    const price = parseFloat(rdv.price) || 0;
                    return sum + price;
                }, 0);
                
                return {
                    totalRdvs,
                    paidRdvs,
                    totalRevenue: Math.round(totalRevenue * 100) / 100
                };
            }
        }
        
        // Fonction pour mettre √† jour l'affichage des statistiques
        async function updateStatsDisplay() {
            const stats = await calculateStats(currentStatsPeriod);
            
            // Mettre √† jour les valeurs dans l'interface
            const revenueEl = document.getElementById('statsRevenue');
            const totalEl = document.getElementById('statsTotal');
            const paidEl = document.getElementById('statsPaid');
            
            if (revenueEl) revenueEl.textContent = `${stats.totalRevenue}‚Ç¨`;
            if (totalEl) totalEl.textContent = stats.totalRdvs;
            if (paidEl) paidEl.textContent = stats.paidRdvs;
            
            console.log(`üìä Stats ${currentStatsPeriod}:`, stats);
        }
        
        // Gestionnaire des boutons de p√©riode
        function initStatsControls() {
            const periodButtons = document.querySelectorAll('.period-btn');
            
            periodButtons.forEach(button => {
                button.addEventListener('click', async () => {
                    // Retirer active de tous les boutons
                    periodButtons.forEach(btn => btn.classList.remove('active'));
                    
                    // Activer le bouton cliqu√©
                    button.classList.add('active');
                    
                    // Changer la p√©riode
                    currentStatsPeriod = button.getAttribute('data-period');
                    
                    // Mettre √† jour les stats
                    await updateStatsDisplay();
                });
            });
            
            // Charger les stats initiales
            updateStatsDisplay();
        }
        
        // Initialiser les contr√¥les quand on va sur la page stats
        document.addEventListener('DOMContentLoaded', () => {
            // Observer les changements de page
            const observer = new MutationObserver(() => {
                const statsPage = document.getElementById('page-stats');
                if (statsPage && statsPage.classList.contains('active')) {
                    initStatsControls();
                }
            });
            
            observer.observe(document.body, {
                attributes: true,
                subtree: true,
                attributeFilter: ['class']
            });
        });

        window.updateStatsDisplay = updateStatsDisplay;

        // ===== SYST√àME DE PAIEMENT =====
        
        let totalPaidAmount = 0;
        
        // Fonction pour calculer le total pay√© depuis les donn√©es
        function calculateTotalPaid() {
            totalPaidAmount = rdvData
                .filter(rdv => rdv.paymentStatus === 'paid')
                .reduce((total, rdv) => total + (parseFloat(rdv.price) || 0), 0);
            
            console.log('üí∞ Total pay√© calcul√©:', totalPaidAmount + '‚Ç¨');
            return totalPaidAmount;
        }
        
        // Fonction pour mettre √† jour l'affichage du total pay√© (si tu veux l'afficher quelque part)
        function updateTotalPaidDisplay() {
            calculateTotalPaid();
            // Mettre √† jour les statistiques si la page est ouverte
            if (document.getElementById('page-stats')?.classList.contains('active')) {
                updateStatsDisplay();
            }
        }
        
        // Fonction pour basculer le statut de paiement d'un RDV
        async function togglePaymentStatus(rdvId) {
            console.log('üí≥ Toggle payment pour RDV:', rdvId);
            
            const rdv = rdvData.find(r => r.id === rdvId);
            if (!rdv) {
                console.error('‚ùå RDV non trouv√©:', rdvId);
                return;
            }
            
            const oldStatus = rdv.paymentStatus || 'unpaid';
            const newStatus = oldStatus === 'paid' ? 'unpaid' : 'paid';
            const price = parseFloat(rdv.price) || 0;
            
            try {
                // Mise √† jour imm√©diate pour l'UX
                rdv.paymentStatus = newStatus;
                
                // Mettre √† jour le bouton visuellement
                updatePaymentButtonDisplay(rdvId, newStatus);
                
                // Calculer le nouveau total
                updateTotalPaidDisplay();
                
                // Sauvegarder dans localStorage
                localStorage.setItem('rdvData', JSON.stringify(rdvData));
                
                // Sauvegarder dans Firestore si disponible
                if (window.db && !isFileMode) {
                    try {
                        console.log('üî• Sauvegarde Firestore...');
                        const { doc, updateDoc } = await import('https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js');
                        
                        const rdvRef = doc(window.db, 'rendez-vous', rdvId);
                        await updateDoc(rdvRef, {
                            paymentStatus: newStatus,
                            updatedAt: new Date().toISOString()
                        });
                        
                        console.log(`‚úÖ Paiement Firestore mis √† jour: ${rdvId} -> ${newStatus}`);
                    } catch (firestoreError) {
                        console.warn('‚ö†Ô∏è Erreur Firestore, donn√©es locales OK:', firestoreError);
                    }
                }
                
                // Log du changement
                const action = newStatus === 'paid' ? 'ajout√©' : 'retir√©';
                console.log(`üí∞ ${price}‚Ç¨ ${action} ${newStatus === 'paid' ? 'au' : 'du'} total`);
                console.log(`üìä Nouveau total pay√©: ${calculateTotalPaid()}‚Ç¨`);
                
            } catch (error) {
                console.error('‚ùå Erreur toggle paiement:', error);
                // Restaurer l'ancien statut en cas d'erreur
                rdv.paymentStatus = oldStatus;
                updatePaymentButtonDisplay(rdvId, oldStatus);
            }
        }
        
        // Fonction pour mettre √† jour l'affichage d'un bouton de paiement sp√©cifique
        function updatePaymentButtonDisplay(rdvId, paymentStatus) {
            const button = document.querySelector(`[onclick*="togglePaymentStatus('${rdvId}')"]`);
            if (button) {
                if (paymentStatus === 'paid') {
                    button.classList.add('checked');
                    button.title = 'Marquer comme non pay√©';
                } else {
                    button.classList.remove('checked');
                    button.title = 'Marquer comme pay√©';
                }
            }
        }
        
        // Modifier la fonction de suppression pour soustraire du total
        function deleteRdv(id) {
            const rdv = rdvData.find(r => r.id === id);
            if (rdv && rdv.paymentStatus === 'paid') {
                const price = parseFloat(rdv.price) || 0;
                console.log(`üí∞ Soustraction du total: -${price}‚Ç¨ (RDV supprim√©)`);
            }
            
            try {
                console.log('üóëÔ∏è Suppression du RDV:', id);
                
                // Supprimer des donn√©es locales
                rdvData = rdvData.filter(r => r.id !== id);
                
                // Sauvegarder en localStorage
                localStorage.setItem('rdvData', JSON.stringify(rdvData));
                
                // Animation de suppression
                const rdvElement = document.querySelector(`[data-rdv-id="${id}"]`);
                if (rdvElement) {
                    rdvElement.style.transform = 'scale(0.8)';
                    rdvElement.style.opacity = '0.3';
                    rdvElement.style.transition = 'all 0.3s ease';
                    
                    // Supprimer l'√©l√©ment du DOM apr√®s l'animation
                    setTimeout(() => {
                        if (rdvElement.parentNode) {
                            rdvElement.remove();
                        }
                    }, 300);
                }
                
                // Mettre √† jour les vues
                updateMobileDateDisplay();
                generateMobileAppointments(rdvData, '');
                
                // Recalculer le total apr√®s suppression
                setTimeout(updateTotalPaidDisplay, 100);
                
                console.log('‚úÖ RDV supprim√© avec succ√®s');
                
            } catch (error) {
                console.error('‚ùå Erreur lors de la suppression:', error);
            }
        }
        
        // Initialiser le syst√®me au chargement
        function initPaymentSystem() {
            calculateTotalPaid();
            console.log('üí≥ Syst√®me de paiement initialis√©');
            console.log('üí∞ Total initial pay√©:', totalPaidAmount + '‚Ç¨');
        }
        
        // Rendre les fonctions accessibles globalement
        window.togglePaymentStatus = togglePaymentStatus;
        window.calculateTotalPaid = calculateTotalPaid;
        window.updateTotalPaidDisplay = updateTotalPaidDisplay;
        window.deleteRdv = deleteRdv;
        
        // Initialiser quand les donn√©es sont charg√©es
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(initPaymentSystem, 1000);
        });

        function confirmDeleteRdv(id) {
            console.log('üóëÔ∏è Suppression rapide du RDV:', id);
            // Suppression directe sans confirmation
            deleteRdv(id);
        }

        // Rendre les fonctions accessibles globalement
        window.confirmDeleteRdv = confirmDeleteRdv;
        window.editRdv = editRdv;


        // Gestion du formulaire
        async function handleRdvSubmit(event) {
            event.preventDefault();
            
            const durationMinutes = 30; // Dur√©e fixe
            const startTime = document.getElementById('rdvTime').value;
            const dateVal = document.getElementById('rdvDate').value;
            const priceVal = document.getElementById('rdvPrice').value;

            // Validation obligatoire: date + prix
            if (!dateVal) {
                showNotification('Veuillez s√©lectionner une date', 'error');
                return;
            }
            if (!startTime) {
                showNotification('Veuillez s√©lectionner une heure', 'error');
                return;
            }
            if (priceVal === '' || isNaN(parseFloat(priceVal)) || parseFloat(priceVal) < 0) {
                showNotification('Veuillez saisir un prix valide (0 ou plus)', 'error');
                return;
            }
            const formData = {
                date: dateVal,
                startTime: startTime,
                endTime: computeEndTime(startTime, durationMinutes),
                durationMinutes,
                price: parseFloat(priceVal) || 0,
                paymentStatus: 'unpaid',
                notes: document.getElementById('rdvNotes').value.trim(),
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };

            console.log('üìù Formulaire soumis, donn√©es:', formData);
            console.log('üìã Nombre RDV avant ajout:', rdvData.length);

            try {
                if (currentEditId) {
                    console.log('‚úèÔ∏è Mode √©dition, ID:', currentEditId);
                    await updateRdv(currentEditId, formData);
                } else {
                    console.log('‚ûï Mode cr√©ation nouveau RDV');
                    await createRdv(formData);
                }
                
                console.log('üìã Nombre RDV apr√®s traitement:', rdvData.length);
                hideModal();
                console.log('‚úÖ Processus termin√©');
                
            } catch (error) {
                console.error('‚ùå Error saving RDV:', error);
                showNotification('Erreur lors de l\'enregistrement', 'error');
            }
        }

        async function createRdv(data) {
            console.log('üöÄ createRdv appel√© avec:', data);
            console.log('üìä RDV existants avant ajout:', rdvData.length);
            
            try {
                // G√©n√©rer un ID unique
                const newId = 'rdv_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                const newRdv = { id: newId, ...data };
                
                console.log('‚úÖ RDV cr√©√©:', newRdv);
                
                rdvData.push(newRdv);
                console.log('üìä Total RDV maintenant:', rdvData.length);
                
                // Sauvegarder localStorage ET Firebase
                localStorage.setItem('rdvData', JSON.stringify(rdvData));
                await saveRdvToFirebase(newRdv);
                
                // Mettre √† jour les statistiques
                updateStats();
                console.log('üíæ RDV sauvegard√© en localStorage et Firebase');
                
                sortRdvData();
                
                // Mettre √† jour l'affichage mobile
                updateMobileDateDisplay();
                generateMobileAppointments(rdvData, '');
                
                showNotification('Rendez-vous ajout√© avec succ√®s', 'success');
                console.log('‚úÖ Cr√©ation RDV termin√©e avec succ√®s');
                
            } catch (error) {
                console.error('‚ùå Erreur lors de la cr√©ation du RDV:', error);
                showNotification('Erreur lors de l\'ajout du rendez-vous', 'error');
            }
        }

        async function updateRdv(id, data) {
            try {
                // Mise √† jour local
                const rdvIndex = rdvData.findIndex(r => r.id === id);
                if (rdvIndex !== -1) {
                    rdvData[rdvIndex] = { ...rdvData[rdvIndex], ...data };
                    
                    // Sauvegarder localStorage ET Firebase
                    localStorage.setItem('rdvData', JSON.stringify(rdvData));
                    await updateRdvInFirebase(id, data);
                    
                    // Mettre √† jour les statistiques
                    updateStats();
                    
                    sortRdvData();
                    updateMobileDateDisplay();
                    generateMobileAppointments(rdvData, '');
                    showNotification('Rendez-vous modifi√© avec succ√®s', 'success');
                } else {
                    showNotification('Rendez-vous introuvable', 'error');
                }
            } catch (error) {
                console.error('‚ùå Erreur lors de la modification:', error);
                showNotification('Erreur lors de la modification', 'error');
            }
        }


        // Fonctions de notification supprim√©es pour √©viter les messages g√™nants
        function showToast(message, type = 'info') {
            // Fonction vide - plus de notifications
        }

        function showNotification(message, type = 'info') {
            // Fonction vide - plus de notifications
        }


        // Restaurer le mode de couleur au chargement
        function initColorScheme() {
            const savedScheme = localStorage.getItem('color-scheme');
            if (savedScheme === 'green') {
                document.body.classList.add('green-mode');
                const toggleBtn = document.getElementById('colorToggleBtn');
                const toggleText = toggleBtn?.querySelector('.toggle-text');
                if (toggleBtn) {
                    toggleBtn.classList.add('active');
                    if (toggleText) toggleText.textContent = 'Mode Orange';
                }
            }
        }

        // Initialiser le scheme de couleur au chargement
        document.addEventListener('DOMContentLoaded', initColorScheme);

        // Mettre √† jour les boutons au chargement
        document.addEventListener('DOMContentLoaded', () => {
            initColorScheme();
            // Petit d√©lai pour s'assurer que les √©l√©ments sont cr√©√©s
            setTimeout(updateAllVideoButtons, 100);
        });

        // Fonction pour supprimer tous les rendez-vous et prix
        async function clearAllAppointmentsAndPrices() {
            if (!confirm('√ätes-vous s√ªr de vouloir supprimer tous les rendez-vous et prix sauvegard√©s ? Cette action est irr√©versible.')) {
                return;
            }
            
            try {
                // Supprimer tous les rendez-vous de Firebase si connect√©
                if (window.db) {
                    const batch = window.firebase.firestore().batch();
                    for (const rdv of rdvData) {
                        if (rdv.id) {
                            const docRef = window.db.collection('rdv').doc(rdv.id);
                            batch.delete(docRef);
                        }
                    }
                    await batch.commit();
                    console.log('‚úÖ Tous les RDV supprim√©s de Firebase');
                }
                
                // Vider le tableau local
                rdvData = [];
                
                // Supprimer tous les prix sauvegard√©s de Firebase
                if (window.db) {
                    const priceSnapshot = await getDocs(collection(window.db, 'customPriceFavorites'));
                    for (const priceDoc of priceSnapshot.docs) {
                        batch.delete(doc(window.db, 'customPriceFavorites', priceDoc.id));
                    }
                }
                
                // Supprimer aussi de localStorage (fallback)
                localStorage.removeItem('customPriceFavorites');
                
                // Mettre √† jour l'affichage
                updateView();
                updateMobileInterface();
                await loadCustomPrices();
                
                showNotification('Tous les rendez-vous et prix ont √©t√© supprim√©s', 'success');
                console.log('‚úÖ Tous les donn√©es supprim√©es');
                
            } catch (error) {
                console.error('Erreur lors de la suppression:', error);
                showNotification('Erreur lors de la suppression', 'error');
            }
        }
    </script>
</body>
</html>